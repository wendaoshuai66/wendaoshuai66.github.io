(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{329:function(s,n,a){"use strict";a.r(n);var e=a(10),t=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"webpack-ä½¿ç”¨æ€»ç»“"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack-ä½¿ç”¨æ€»ç»“"}},[s._v("#")]),s._v(" Webpack ä½¿ç”¨æ€»ç»“")]),s._v(" "),n("h2",{attrs:{id:"å‰ç«¯çš„å‘å±•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å‰ç«¯çš„å‘å±•"}},[s._v("#")]),s._v(" å‰ç«¯çš„å‘å±•")]),s._v(" "),n("p",[s._v("è¿‘å¹´æ¥ Web åº”ç”¨å˜å¾—æ›´åŠ å¤æ‚ä¸åºå¤§ï¼Œ Web å‰ç«¯æŠ€æœ¯çš„åº”ç”¨èŒƒå›´ä¹Ÿæ›´åŠ å¹¿æ³›ã€‚é€šè¿‡ç›´æ¥ç¼–å†™ JavaScriptã€cssã€ HTML å¼€å‘ Web åº”ç”¨çš„æ–¹å¼å·±ç»æ— æ³•åº”å¯¹å½“å‰ Web åº”ç”¨çš„å‘å±• ã€‚ è¿‘å¹´æ¥ï¼Œå‰ç«¯ç¤¾åŒºæ¶Œç°å‡º è®¸ å¤šæ–°æ€æƒ³ä¸æ¡†æ¶ï¼Œä¸‹é¢å°†ä¸€ä¸€ä»‹ç»å®ƒ ä»¬ ã€‚")]),s._v(" "),n("h3",{attrs:{id:"æ¨¡å—åŒ–"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ¨¡å—åŒ–"}},[s._v("#")]),s._v(" æ¨¡å—åŒ–")]),s._v(" "),n("p",[s._v("æ¨¡å—åŒ–æ˜¯æŒ‡å°†ä¸€ä¸ªå¤æ‚çš„ç³»ç»Ÿåˆ†è§£ä¸ºå¤šä¸ªæ¨¡å—ï¼Œæ–¹ä¾¿ç¼–ç ")]),s._v(" "),n("p",[s._v("å¾ˆä¹…ä»¥å‰ï¼Œå¼€å‘ç½‘é¡µè¦é€šè¿‡å‘½åç©ºé—´çš„æ–¹å¼æ¥ç»„ç»‡ä»£ç ï¼Œä¾‹å¦‚ jQuery åº“å°†å®ƒçš„ API éƒ½æ”¾ åœ¨äº† window .$ä¸‹ï¼Œåœ¨åŠ è½½å®Œ jQue ç”ºåï¼Œå…¶ä»–æ¨¡å—å†é€šè¿‡ window . â™€å»ä½¿ç”¨ jQueryã€‚è¿™æ ·åš æœ‰å¾ˆå¤šé—®é¢˜ï¼Œå…¶ä¸­åŒ…æ‹¬:")]),s._v(" "),n("p",[s._v("å‘½åç©ºé—´å†²çªï¼Œä¸¤ä¸ªåº“å¯èƒ½ä¼šä½¿ç”¨åŒä¸€ä¸ªåç§°ï¼Œä¾‹å¦‚ Zepto (http://zeptojs.com)ä¹Ÿ è¢«æ”¾åœ¨ w å·¥ ndow.$ä¸‹")]),s._v(" "),n("p",[s._v("æ— æ³•åˆç†åœ°ç®¡ç†é¡¹ç›®çš„ä¾èµ–å’Œç‰ˆæœ¬")]),s._v(" "),n("p",[s._v("æ— æ³•æ–¹ä¾¿åœ°æ§åˆ¶ä¾èµ–çš„åŠ è½½é¡ºåºã€‚")]),s._v(" "),n("p",[s._v("ç›´ç™½ä¸€äº›å°±æ˜¯å¼€å‘æ•ˆç‡ä¼šä½ï¼Œç»´æŠ¤æˆæœ¬ä¼šå¤§ã€‚")]),s._v(" "),n("h4",{attrs:{id:"commonjs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#commonjs"}},[s._v("#")]),s._v(" CommonJS")]),s._v(" "),n("p",[s._v("CommonJS æ˜¯ä¸€ç§å¹¿æ³›åº”ç”¨çš„ Javascript æ¨¡å—åŒ–è§„èŒƒï¼Œæ ¸å¿ƒï¼š")]),s._v(" "),n("p",[s._v("require æ–¹æ³•åŒæ­¥åŠ è½½ä¾èµ–çš„å…¶ä»–æ¨¡å—ï¼Œ")]),s._v(" "),n("p",[s._v("module.exports å¯¼å‡ºéœ€è¦çš„æ¥å£")]),s._v(" "),n("p",[s._v("CommonJS çš„æµè¡Œ çš„ç›Šäº node é‡‡ç”¨è¯¥æ–¹å¼ï¼Œåæ¥è¿™ç§æ–¹å¼è¢«å¼•å…¥åˆ°ç½‘é¡µä¸­å¼€å‘")]),s._v(" "),n("p",[s._v("é‡‡ç”¨ CommonJS å¯¼å…¥åŠå¯¼å‡ºçš„ä»£ç å¦‚ä¸‹:")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v("// å¯¼å…¥\nconst moduleA = require ( â€™. / moduleA â€™); // å¯¼å‡º\nmodule .exports = moduleA.someFunc;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("CommonJS çš„ä¼˜ç‚¹åœ¨äº:")]),s._v(" "),n("p",[s._v("1.ä»£ç å¯å¤ç”¨äº Node.js ç¯å¢ƒä¸­ï¼Œä¾‹å¦‚åšåŒæ„")]),s._v(" "),n("p",[s._v("2.é€šè¿‡ npm å‘å¸ƒçš„å¾ˆå¤šç¬¬ä¸‰æ–¹æ¨¡å—éƒ½é‡‡ç”¨äº†ï¼ŒCommonJS è§„èŒƒã€‚")]),s._v(" "),n("p",[s._v("ç¼ºç‚¹ï¼š")]),s._v(" "),n("p",[s._v("1.ä¸èƒ½ç›´æ¥åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­è¿è¡Œï¼Œå¿…é¡»é€šè¿‡å·¥å…·è½¬æ¢ä¸º ES5 çš„æ ‡å‡†")]),s._v(" "),n("p",[s._v("å†å²")]),s._v(" "),n("p",[s._v("CommonJS è¿˜å¯ä»¥ç»†åˆ†ä¸º CommonJSl å’Œ CommonJS2")]),s._v(" "),n("p",[s._v("CommonJS1 å’Œ CommonJS2 åŒºåˆ«ï¼š")]),s._v(" "),n("p",[s._v("CommonJS1 åªèƒ½é€šè¿‡ exports . XX = XX å¯¼å‡º")]),s._v(" "),n("p",[s._v("CommonJS2 åœ¨ CommonJSl çš„åŸºç¡€ä¸ŠåŠ å…¥äº† module. exports = XX")]),s._v(" "),n("h4",{attrs:{id:"amd"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#amd"}},[s._v("#")]),s._v(" AMD")]),s._v(" "),n("p",[s._v("AMD ä¹Ÿæ˜¯ä¸€ç§ JavaScript æ¨¡å—åŒ–è§„èŒƒã€‚")]),s._v(" "),n("p",[s._v("AMD ä¸ CommonJS åŒºåˆ«ï¼šAMD é‡‡ç”¨äº†å¼‚æ­¥çš„æ–¹å¼å»åŠ è½½ä¾èµ–çš„æ¨¡å—ã€‚")]),s._v(" "),n("p",[s._v("AMD ä¸»è¦ç”¨äºè§£å†³é’ˆå¯¹æµè§ˆå™¨ç¯å¢ƒçš„æ¨¡å—åŒ–é—®é¢˜ï¼Œæœ€å…·ä»£è¡¨æ€§çš„å®ç°æ˜¯ requirejsã€‚")]),s._v(" "),n("p",[s._v("é‡‡ç”¨ AMD å¯¼å…¥åŠå¯¼å‡ºçš„ä»£ç å¦‚ä¸‹:")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v("é‡‡ç”¨ AMD å¯¼å…¥åŠå¯¼å‡ºçš„ä»£ç å¦‚ä¸‹:\n// å®šä¹‰ä¸€ä¸ªæ¨¡å—\ndefine (â€™ module â€™ , [ â€™ dep â€™] , function (dep) {\nrequirejs\n(http://\nreturn exports;\n});\n//å¯¼å…¥å’Œä½¿ç”¨\nrequire ([â€™moduleâ€™] , });\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("AMD çš„ä¼˜ç‚¹åœ¨äº:")]),s._v(" "),n("p",[s._v("1.å¯åœ¨ä¸è½¬æ¢ä»£ç çš„æƒ…å†µä¸‹ç›´æ¥åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­è¿è¡Œ")]),s._v(" "),n("p",[s._v("2.å¼‚æ­¥åŠ è½½ä¾èµ–")]),s._v(" "),n("p",[s._v("3.å¯ä»¥å¹¶è¡ŒåŠ è½½å¤šä¸ªä¾èµ–")]),s._v(" "),n("p",[s._v("4.ä»£ç å¯ä»¥åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ä¸ Node ç¯å¢ƒä¸­è¿è¡Œ")]),s._v(" "),n("p",[s._v("AMD çš„ä¼˜ç‚¹åœ¨äº:")]),s._v(" "),n("p",[s._v("JavaScript è¿è¡Œç¯å¢ƒæ²¡æœ‰åŸç”Ÿæ”¯æŒ AMDã€‚ï¼Œ éœ€è¦å…ˆå¯¼å…¥å®ç°äº† AMD çš„åº“ åæ‰èƒ½æ­£å¸¸ä½¿ç”¨ã€‚")]),s._v(" "),n("h4",{attrs:{id:"es6-æ¨¡å—åŒ–"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#es6-æ¨¡å—åŒ–"}},[s._v("#")]),s._v(" ES6 æ¨¡å—åŒ–")]),s._v(" "),n("p",[s._v("ES6 æ¨¡å—åŒ–æ˜¯å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ ECMA æå‡ºçš„ JavaScript æ¨¡å—åŒ–è§„èŒƒï¼Œå®ƒåœ¨ è¯­è¨€å±‚é¢ä¸Šå® ç°äº†æ¨¡å—åŒ–ã€‚æµè§ˆå™¨å‚å•†å’Œ Node. éƒ½å®£å¸ƒè¦åŸç”Ÿæ”¯æŒè¯¥è§„èŒƒ ã€‚ å®ƒå°†é€æ¸å–ä»£ CommonJS å’Œ AMD è§„èŒƒï¼Œæˆä¸ºæµè§ˆå™¨å’ŒæœåŠ¡å™¨é€šç”¨çš„æ¨¡å—è§£å†³æ–¹æ¡ˆ ã€‚")]),s._v(" "),n("p",[s._v("é‡‡ç”¨ ES6 æ¨¡å—åŒ–å¯¼å…¥åŠå¯¼å‡ºçš„ä»£ç å¦‚ä¸‹:")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v("//å¯¼ å…¥\nimport { readFile } from â€™ fs â€™; import React from â€™reactâ€™; //å¯¼å‡º\nexport function hello {) {};\n\nexport default {\n\n...\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"å¸¸è§çš„æ„å»ºå·¥å…·åŠå¯¹æ¯”"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å¸¸è§çš„æ„å»ºå·¥å…·åŠå¯¹æ¯”"}},[s._v("#")]),s._v(" å¸¸è§çš„æ„å»ºå·¥å…·åŠå¯¹æ¯”")]),s._v(" "),n("h4",{attrs:{id:"gulp"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#gulp"}},[s._v("#")]),s._v(" Gulp")]),s._v(" "),n("p",[s._v("Gulp æ˜¯åŸºäºæµçš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ã€‚å¯ä»¥ç®¡ç†å’Œæ‰§è¡Œä»»åŠ¡ã€‚è¿˜å¯ä»¥æ”¯æŒç›‘å¬æ–‡ä»¶ï¼Œä¸è¯»å†™æ–‡ä»¶")]),s._v(" "),n("p",[s._v("Gulp è¢«è®¾è®¡å¾—éå¸¸ç®€å•ï¼Œåªé€šè¿‡ä¸‹é¢ 5 ç§æ–¹æ³•å°±å¯ä»¥æ”¯æŒå‡ ä¹ æ‰€æœ‰æ„å»ºåœºæ™¯:")]),s._v(" "),n("p",[s._v("1.gulp.task æ³¨å†Œä»»åŠ¡")]),s._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[s._v("gulp.run æ‰§è¡Œä»»åŠ¡")])]),s._v(" "),n("p",[s._v("3.gulp.watch ç›‘å¬ä»»åŠ¡")]),s._v(" "),n("p",[s._v("4.gulp.src è¯»å–æ–‡ä»¶")]),s._v(" "),n("p",[s._v("5.gulp.dest å†™æ–‡ä»¶")]),s._v(" "),n("p",[s._v("ä¸¾ä¸ªä¾‹å­ Gulp å’Œ Rollup å®ç°äº†å¯¹æ•°æ®çš„æµæ¸…æ´—")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v("const gulp = require('gulp');\nconst watch = require('gulp-watch');\nconst rollup = require('gulp-rollup');\nconst babel = require('gulp-babel');\nconst replace = require('rollup-plugin-replace')\nconst entry = './src/server/**/*.js';\nconst clearEntry = [\"./src/server/config/index.js\"]\n\n\nfunction buildenv() {\n    return watch(entry, { ignoreInitial: false }, function() {\n            gulp.src(entry)\n                .pipe(babel({\n                    //éå¸¸é‡è¦ä¸€ç‚¹ï¼Œæ¶‰åŠåˆ°è‡ªå·±ç‹¬ç«‹çš„ç¼–è¯‘ï¼Œå¤–é¢çš„ç•™ç»™å‰ç«¯\n                    babelrc: false,\n                    \"plugins\": [\n                        [\"@babel/plugin-proposal-decorators\", { \"legacy\": true }],\n                        \"@babel/plugin-transform-modules-commonjs\"\n                    ]\n                })).pipe(gulp.dest('dist'))\n        })\n        // .pipe(gulp.dest('dist')); æ”¾å¤–é¢ç›‘æµ‹ä¸åˆ°ï¼Œæœ‰ç‚¹æ¯›ç—… ğŸ˜”\n\n}\n//ä¸å¼€å‘æ²¡æœ‰å¤šå¤§åŒºåˆ«ï¼Œåªä¸è¿‡è¦åŠ ä¸€ä¸ªæµå¼æ¸…æ´—\nfunction buildprod() {\n\n    return gulp.src(entry)\n        .pipe(babel({\n            //éå¸¸é‡è¦ä¸€ç‚¹ï¼Œæ¶‰åŠåˆ°è‡ªå·±ç‹¬ç«‹çš„ç¼–è¯‘ï¼Œå¤–é¢çš„ç•™ç»™å‰ç«¯\n            babelrc: false,\n            ignore: clearEntry,\n            \"plugins\": [\n                [\"@babel/plugin-proposal-decorators\", { \"legacy\": true }],\n                \"@babel/plugin-transform-modules-commonjs\"\n            ]\n        })).pipe(gulp.dest('dist'))\n}\n\nfunction buildconfig() {\n    return gulp.src(entry)\n        .pipe(rollup({\n            //æ³¨æ„ä¸€ç‚¹è¦ç¼–è¯‘æˆcommonjs\n            output: {\n                format: \"cjs\"\n            },\n            input: clearEntry,\n            //ç”±äºæ‰“åŒ…åï¼Œå¯¹process.env.NODE_ENVæ²¡æœ‰å¤„ç†\n            plugins: [\n                replace({\n                    \"process.env.NODE_ENV\": JSON.stringify('production')\n                })\n            ]\n        }))\n        .pipe(gulp.dest('./dist'));\n}\n\nfunction lint() {\n\n}\nlet build = gulp.series(buildenv)\n\nif (process.env.NODE_ENV == 'lint') {\n    build = gulp.series(lint)\n}\nif (process.env.NODE_ENV == 'production') {\n    build = gulp.series(buildprod, buildconfig)\n}\ngulp.task(\"default\", build)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br")])]),n("h4",{attrs:{id:"webpack"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack"}},[s._v("#")]),s._v(" Webpack")]),s._v(" "),n("p",[s._v("Webpack æ˜¯ä¸€ä¸ªæ‰“åŒ…æ¨¡å—åŒ– js çš„å·¥å…·ğŸ”§ï¼Œåœ¨ Webpack ä¸­ä¸€åˆ‡çš†æ¨¡å—ï¼Œé€šè¿‡ loader è½¬åŒ–æ–‡ä»¶ï¼Œé€šè¿‡ Plugin æ³¨å…¥é’©å­ï¼Œæœ€åè¾“å‡ºç”±å¤šä¸ªæ¨¡å—ç»„åˆæˆçš„æ–‡ä»¶ğŸ“ƒã€‚")]),s._v(" "),n("p",[s._v("ä¸€åˆ‡æ–‡ä»¶å¦‚ JavaScriptã€ cssã€ scssã€å›¾ç‰‡ã€æ¨¡æ¿ï¼Œå¯¹äº Webpack æ¥è¯´éƒ½æ˜¯ä¸€ä¸ªä¸ªæ¨¡å—")]),s._v(" "),n("h4",{attrs:{id:"rollup"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rollup"}},[s._v("#")]),s._v(" Rollup")]),s._v(" "),n("p",[s._v("Rollup (https://rollupjs.org)æ˜¯ä¸€ä¸ªå’Œ Webpack å¾ˆç±»ä¼¼ä½†ä¸“æ³¨äº ES6 çš„æ¨¡å—æ‰“åŒ…å·¥å…·ã€‚å®ƒ çš„äº®ç‚¹ åœ¨äºï¼Œèƒ½é’ˆå¯¹ ES6 æºç è¿›è¡Œ Tree Shakingï¼Œä»¥å»é™¤é‚£äº›å·±è¢«å®šä¹‰ä½†æ²¡è¢«ä½¿ç”¨çš„ä»£ç  å¹¶è¿› è¡Œ Scope Hoistingï¼Œä»¥å‡å°è¾“å‡º æ–‡ä»¶çš„å¤§ å°å’Œæå‡è¿è¡Œæ€§èƒ½ ã€‚ç„¶è€Œ Rollup çš„è¿™äº›äº®ç‚¹éšåå°±è¢« Webpack æ¨¡ä»¿å’Œå®ç°ã€‚ç”±äº Rollup çš„ä½¿ç”¨æ–¹æ³•å’Œ Webpack å·®ä¸å¤š ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸è¯¦ç»†ä»‹ç»å¦‚ ä½•ä½¿ç”¨ Rollup äº†ï¼Œè€Œæ˜¯è¯¦ç»†è¯´æ˜å®ƒä»¬çš„å·®åˆ«:")]),s._v(" "),n("p",[s._v("â€¢ Rollup æ˜¯åœ¨ Webpack æµè¡Œåå‡º ç°çš„æ›¿ä»£å“")]),s._v(" "),n("p",[s._v("â€¢ Rollup ç”Ÿæ€é“¾è¿˜ä¸å®Œå–„ï¼Œä½“éªŒä¸ å¦‚ Webpack\nâ€¢ Rollup çš„åŠŸèƒ½ä¸å¦‚ Webpack å®Œå–„ ï¼Œä½†å…¶é…ç½®å’Œä½¿ç”¨æ›´ç®€å•")]),s._v(" "),n("p",[s._v("â€¢ Rollup ä¸æ”¯æŒ CodeSplitingï¼Œä½†å¥½å¤„æ˜¯åœ¨æ‰“åŒ…å‡ºæ¥çš„ä»£ç ä¸­æ²¡æœ‰ Webpack é‚£æ®µæ¨¡å— çš„åŠ è½½ã€æ‰§è¡Œå’Œç¼“å­˜çš„ä»£ç ")]),s._v(" "),n("h2",{attrs:{id:"æ•´ä½“æµç¨‹åˆ†æ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ•´ä½“æµç¨‹åˆ†æ"}},[s._v("#")]),s._v(" æ•´ä½“æµç¨‹åˆ†æ")]),s._v(" "),n("h5",{attrs:{id:"ç¬¬ä¸€æ­¥-æ‰§è¡Œ-webpack-å‡½æ•°-åœ¨-webpack-å‡½æ•°ä¸­åˆå§‹åŒ–-compiler-å¯¹è±¡-new-compiler-options-context-åˆå§‹åŒ–è‡ªå®šä¹‰æ’ä»¶-plugin-apply-compiler"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬ä¸€æ­¥-æ‰§è¡Œ-webpack-å‡½æ•°-åœ¨-webpack-å‡½æ•°ä¸­åˆå§‹åŒ–-compiler-å¯¹è±¡-new-compiler-options-context-åˆå§‹åŒ–è‡ªå®šä¹‰æ’ä»¶-plugin-apply-compiler"}},[s._v("#")]),s._v(" ç¬¬ä¸€æ­¥ï¼Œæ‰§è¡Œ webpack å‡½æ•°ï¼Œåœ¨ webpack å‡½æ•°ä¸­åˆå§‹åŒ– compiler å¯¹è±¡ new Compiler(options.context)ï¼Œåˆå§‹åŒ–è‡ªå®šä¹‰æ’ä»¶ plugin.apply(compiler)")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v('const webpack = (options, callback) => {\n\tlet compiler;\n\tif (typeof options === "object") {\n\t\toptions = new WebpackOptionsDefaulter().process(options);\n\t\t//åˆ›å»ºç¼–è¯‘å¯¹è±¡\n\t\tcompiler = new Compiler(options.context);\n\t\tcompiler.options = options;\n\t\t\n\t\t\n\t\t//å°†Node.jsæ ¼å¼çš„æ–‡ä»¶ç³»ç»Ÿåº”ç”¨äºcompilerã€‚\n\t\tnew NodeEnvironmentPlugin({\n\t\t\tinfrastructureLogging: options.infrastructureLogging\n\t\t}).apply(compiler);\n\t\tif (options.plugins && Array.isArray(options.plugins)) {\n\t\t\tfor (const plugin of options.plugins) {\n\t\t\t// æ‰§è¡Œè‡ªå®šä¹‰æ’ä»¶\n\t\t\t\tif (typeof plugin === "function") {\n\t\t\t\t\tplugin.call(compiler, compiler);\n\t\t\t\t} else {\n\t\t\t\t\n\t\t\t\t\tplugin.apply(compiler);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//è§¦å‘environmenté’©å­å‡½æ•°ï¼šåœ¨å‡†å¤‡ç¯å¢ƒä¹‹å‰è¿è¡Œæ’ä»¶ã€‚\n\t\tcompiler.hooks.environment.call();\n\t\t// è§¦å‘afterEnvironmenté’©å­å‡½æ•°ï¼šæ‰§è¡Œæ’ä»¶ç¯å¢ƒè®¾ç½®å®Œæˆã€‚\n\t\tcompiler.hooks.afterEnvironment.call();\n\t\t//å¤„ç†é…ç½®ä¸­çš„targetå‚æ•°ï¼Œä¾‹å¦‚ webï¼Œnodeï¼Œæ ¹æ®ä¸åŒé…ç½®ï¼Œé…ç½®é»˜è®¤çš„pluginã€‚\n\t\tcompiler.options = new WebpackOptionsApply().process(options, compiler);\n\t} \n\tif (callback) {\n\t // å¼€å§‹ç¼–è¯‘\n\t\tcompiler.run(callback);\n\t}\n\t// è¿”å›compiler\n\treturn compiler;\n};\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br")])]),n("p",[s._v("compiler.run(callbackï¼‰æ‰§è¡Œåï¼Œå°±ä¼šæ ¹æ®ç”Ÿå‘½å‘¨æœŸï¼Œæ‰§è¡Œå¯¹åº”çš„äº‹ä»¶é’©å­å‡½æ•°")]),s._v(" "),n("h5",{attrs:{id:"ç¬¬äºŒæ­¥-è§¦å‘-webpackoptionsapply-ä¸­é—´ä»¶"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬äºŒæ­¥-è§¦å‘-webpackoptionsapply-ä¸­é—´ä»¶"}},[s._v("#")]),s._v(" ç¬¬äºŒæ­¥ï¼Œè§¦å‘ WebpackOptionsApply ä¸­é—´ä»¶")]),s._v(" "),n("p",[s._v("åœ¨ compilation é˜¶æ®µä¼šè®°å½•å¥½ä¾èµ–çš„å·¥å‚ç±»ã€‚")]),s._v(" "),n("p",[s._v("åœ¨ make é˜¶æ®µçš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ª SingleEntryPlugin å®ä¾‹ã€‚")]),s._v(" "),n("p",[s._v("è°ƒç”¨ compilation.addEntry æ–¹æ³•ã€‚")]),s._v(" "),n("p",[s._v("addEntry ä¼šè°ƒç”¨ _addModuleChain æ–¹æ³•ï¼Œæœ€ç»ˆç»è¿‡å‡ æ¬¡è°ƒç”¨åä¼šè¿›å…¥åˆ° NormalModule.js ä¸­çš„ build æ–¹æ³•ã€‚")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v('class WebpackOptionsApply extends OptionsApply {\n    process(options, compiler) {\n         ...\n        if (typeof options.target === "string") {\n            let JsonpTemplatePlugin;\n            let FetchCompileWasmTemplatePlugin;\n            let ReadFileCompileWasmTemplatePlugin;\n            let NodeSourcePlugin;\n            let NodeTargetPlugin;\n            let NodeTemplatePlugin;\n\n            switch (options.target) {\n                case "web":\n                    ...\n                    break;\n                case "webworker":\n                    {\n                    ....\n                        break;\n                    }\n                case "node":\n                case "async-node":\n                  ...\n                    break;\n                case "node-webkit":\n                ...\n                    break;\n                case "electron-main":\n\n                    break;\n                case "electron-renderer":\n                case "electron-preload":\n\n                    break;\n\n            }\n        }\n        ...\n        new EntryOptionPlugin().apply(compiler);\n        ...\n    }\n}\n\nmodule.exports = WebpackOptionsApply;\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br")])]),n("p",[s._v("ä¸Šè¿°ä»£ç  new EntryOptionPlugin().apply(compiler) çš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ª SingleEntryPlugin å®ä¾‹ã€‚")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v("// WebpackOptionsApply -> EntryOptionPlugin ->SingleEntryPlugin\nclass SingleEntryPlugin {\n  apply(compiler) {\n    compiler.hooks.compilation.tap(\n      'SingleEntryPlugin',\n      (compilation, { normalModuleFactory }) => {\n        compilation.dependencyFactories.set(\n          SingleEntryDependency,\n          normalModuleFactory\n        );\n      }\n    );\n    compiler.hooks.make.tapAsync(\n      'SingleEntryPlugin',\n      (compilation, callback) => {\n        const { entry, name, context } = this;\n        const dep = SingleEntryPlugin.createDependency(entry, name);\n        compilation.addEntry(context, dep, name, callback);\n      }\n    );\n  }\n  static createDependency(entry, name) {\n    const dep = new SingleEntryDependency(entry);\n    dep.loc = { name };\n    return dep;\n  }\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("p",[s._v("è°ƒç”¨ compilation.addEntry æ–¹æ³•ã€‚")]),s._v(" "),n("p",[s._v("addEntry ä¼šè°ƒç”¨ _addModuleChain æ–¹æ³•ï¼Œæœ€ç»ˆç»è¿‡å‡ æ¬¡è°ƒç”¨åä¼šè¿›å…¥åˆ° NormalModule.js ä¸­çš„ build æ–¹æ³•ã€‚")]),s._v(" "),n("h5",{attrs:{id:"ç¬¬ä¸‰æ­¥-è°ƒç”¨-normalmodule-ä¸­çš„-build-æ–¹æ³•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬ä¸‰æ­¥-è°ƒç”¨-normalmodule-ä¸­çš„-build-æ–¹æ³•"}},[s._v("#")]),s._v(" ç¬¬ä¸‰æ­¥ï¼Œè°ƒç”¨ NormalModule ä¸­çš„ build æ–¹æ³•")]),s._v(" "),n("p",[s._v("build æ–¹æ³•ä¼šå…ˆæ‰§è¡Œ doBuildï¼Œå°†åŸå§‹ä»£ç ç»è¿‡ loader è¿›è¡Œè½¬ä¹‰ã€‚")]),s._v(" "),n("p",[s._v("ç»è¿‡ doBuild ä¹‹åï¼Œæˆ‘ä»¬çš„ä»»ä½•æ¨¡å—éƒ½è¢«è½¬æˆäº†æ ‡å‡†çš„ JS æ¨¡å—ï¼Œé‚£ä¹ˆä¸‹é¢æˆ‘ä»¬å°±å¯ä»¥ç¼–è¯‘ JS äº†")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v("doBuild(options, compilation, resolver, fs, callback) {\n  const loaderContext = this.createLoaderContext(\n    resolver,\n    options,\n    compilation,\n    fs\n  );\n  // æ‰§è¡Œloaders\n  runLoaders(\n    {\n        resource: this.resource,\n        loaders: this.loaders,\n        context: loaderContext,\n        readResource: fs.readFile.bind(fs)\n    },\n    (err, result) => {\n      if (result) {\n          this.buildInfo.cacheable = result.cacheable;\n          this.buildInfo.fileDependencies = new Set(result.fileDependencies);\n          this.buildInfo.contextDependencies = new Set(\n              result.contextDependencies\n          );\n      }\n      // result æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„ç¬¬ä¸€é¡¹å°±æ˜¯ç¼–è¯‘åçš„ä»£ç \n      const resourceBuffer = result.resourceBuffer;\n      const source = result.result[0];\n      const sourceMap = result.result.length >= 1 ? result.result[1] : null;\n      const extraInfo = result.result.length >= 2 ? result.result[2] : null;\n      // this._source æ˜¯ä¸€ä¸ª å¯¹è±¡ï¼Œæœ‰nameå’Œvalueä¸¤ä¸ªå­—æ®µï¼Œnameå°±æ˜¯æˆ‘ä»¬çš„æ–‡ä»¶è·¯å¾„ï¼Œvalueå°±æ˜¯ ç¼–è¯‘åçš„JSä»£ç \n      this._source = this.createSource(\n          this.binary ? asBuffer(source) : asString(source),\n          resourceBuffer,\n          sourceMap\n      );\n      return callback();\n    }\n  );\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br")])]),n("h5",{attrs:{id:"ç¬¬å››æ­¥-è°ƒç”¨-parser-parse-æ–¹æ³•-å°†ä»£ç è½¬æ¢æˆ-astã€‚-ä½¿ç”¨-parser-åˆ†æé¡¹ç›®ä¾èµ–"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬å››æ­¥-è°ƒç”¨-parser-parse-æ–¹æ³•-å°†ä»£ç è½¬æ¢æˆ-astã€‚-ä½¿ç”¨-parser-åˆ†æé¡¹ç›®ä¾èµ–"}},[s._v("#")]),s._v(" ç¬¬å››æ­¥ï¼Œè°ƒç”¨ parser.parse æ–¹æ³•ï¼Œå°†ä»£ç è½¬æ¢æˆ astã€‚ ä½¿ç”¨ Parser åˆ†æé¡¹ç›®ä¾èµ–")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v("build(options, compilation, resolver, fs, callback) {\n  return this.doBuild(options, compilation, resolver, fs, err => {\n    // ç¼–è¯‘æˆast\n    const result = this.parser.parse(\n      this._ast || this._source.source(),\n      {\n          current: this,\n          module: this,\n          compilation: compilation,\n          options: options\n      },\n      (err, result) => {\n          if (err) {\n              handleParseError(err);\n          } else {\n              handleParseResult(result);\n          }\n      }\n    );\n  });\n}\n\nstatic parse(code, options) {\n  let ast;\n  let error;\n  let threw = false;\n  try {\n      // ç¼–è¯‘æˆast\n      ast = acorn.parse(code, parserOptions);\n  } catch (e) {\n      error = e;\n      threw = true;\n  }\n  return ast;\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br")])]),n("h5",{attrs:{id:"ç¬¬äº”æ­¥-è§£æå®Œ-ast-å-å°±ä¼šå¯¹æ¯ä¸ªæ¨¡å—æ‰€ä¾èµ–çš„å¯¹è±¡è¿›è¡Œæ”¶é›†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬äº”æ­¥-è§£æå®Œ-ast-å-å°±ä¼šå¯¹æ¯ä¸ªæ¨¡å—æ‰€ä¾èµ–çš„å¯¹è±¡è¿›è¡Œæ”¶é›†"}},[s._v("#")]),s._v(" ç¬¬äº”æ­¥ï¼Œè§£æå®Œ ast åï¼Œå°±ä¼šå¯¹æ¯ä¸ªæ¨¡å—æ‰€ä¾èµ–çš„å¯¹è±¡è¿›è¡Œæ”¶é›†")]),s._v(" "),n("p",[s._v("å¦‚æœæˆ‘ä»¬æœ‰ import a from 'a.js' è¿™æ ·çš„è¯­å¥ï¼Œé‚£ä¹ˆç»è¿‡ babel-loader ä¹‹åä¼šå˜æˆ var a = require('./a.js') ï¼Œè€Œå¯¹è¿™ä¸€å¥çš„å¤„ç†å°±åœ¨ walkStatements ä¸­ï¼Œè¿™é‡Œç»è¿‡äº†å‡ æ¬¡è·³è½¬ï¼Œæœ€ç»ˆä¼šå‘ç°è¿›å…¥äº† walkVariableDeclarators æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬è¿™æ˜¯å£°æ˜äº†ä¸€ä¸ª a å˜é‡ã€‚è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v("// import a from 'a.js'\nwalkVariableDeclaration(statement) {\n  for (const declarator of statement.declarations) {\n    switch (declarator.type) {\n      case \"VariableDeclarator\": {\n        // è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„å˜é‡å a\n        this.walkPattern(declarator.id);\n        // è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„è¡¨è¾¾å¼ `require('./a.js')`\n        if (declarator.init) this.walkExpression(declarator.init);\n        break;\n      }\n    }\n  }\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("p",[s._v("è¿™é‡Œçš„ require('./a.js') æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œåœ¨è¿™é‡Œå°±ä¼šåˆ›å»ºä¸€ä¸ªä¾èµ–ï¼Œè®°å½•ä¸‹å¯¹ a.js æ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œæœ€ç»ˆè¿™äº›ä¾èµ–ä¼šè¢«æ”¾åˆ° module.dependencies ä¸­")]),s._v(" "),n("h5",{attrs:{id:"åœ¨æ”¶é›†å®Œæ‰€æœ‰ä¾èµ–ä¹‹å-ä¼šè°ƒç”¨-compilation-seal-æ–¹æ³•ã€‚-ä½¿ç”¨-template-ç”Ÿæˆç»“æœä»£ç "}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åœ¨æ”¶é›†å®Œæ‰€æœ‰ä¾èµ–ä¹‹å-ä¼šè°ƒç”¨-compilation-seal-æ–¹æ³•ã€‚-ä½¿ç”¨-template-ç”Ÿæˆç»“æœä»£ç "}},[s._v("#")]),s._v(" åœ¨æ”¶é›†å®Œæ‰€æœ‰ä¾èµ–ä¹‹åï¼Œä¼šè°ƒç”¨ compilation.seal æ–¹æ³•ã€‚ ä½¿ç”¨ Template ç”Ÿæˆç»“æœä»£ç ")]),s._v(" "),n("p",[s._v("éå†æ‰€æœ‰çš„ chunk å’Œ chunk æ‰€ä¾èµ–çš„æ–‡ä»¶ã€‚")]),s._v(" "),n("p",[s._v("å°†è¿™äº›æ–‡ä»¶é€šè¿‡è°ƒç”¨ MainTemplate ä¸­çš„ render ç”Ÿæˆæœ€ç»ˆä»£ç ã€‚")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v('// å°†ç»“æœåŒ…è£¹åˆ°ä¸€ä¸ªIIFEä¸­\nrenderBootstrap(hash, chunk, moduleTemplate, dependencyTemplates) {\n  const buf = [];\n  buf.push(\n    this.hooks.bootstrap.call(\n      "",\n      chunk,\n      hash,\n      moduleTemplate,\n      dependencyTemplates\n    )\n  );\n  buf.push(this.hooks.localVars.call("", chunk, hash));\n  buf.push("");\n  buf.push("// The require function");\n  buf.push(`function ${this.requireFn}(moduleId) {`);\n  buf.push(Template.indent(this.hooks.require.call("", chunk, hash)));\n  buf.push("}");\n  buf.push("");\n  buf.push(\n    Template.asString(this.hooks.requireExtensions.call("", chunk, hash))\n  );\n  buf.push("");\n  buf.push(Template.asString(this.hooks.beforeStartup.call("", chunk, hash)));\n  buf.push(Template.asString(this.hooks.startup.call("", chunk, hash)));\n  return buf;\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("h2",{attrs:{id:"webpack-æ•´ä½“æµç¨‹åˆ†ææ€»ç»“"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack-æ•´ä½“æµç¨‹åˆ†ææ€»ç»“"}},[s._v("#")]),s._v(" webpack æ•´ä½“æµç¨‹åˆ†ææ€»ç»“")]),s._v(" "),n("h3",{attrs:{id:"æµç¨‹æ¦‚æ‹¬"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æµç¨‹æ¦‚æ‹¬"}},[s._v("#")]),s._v(" æµç¨‹æ¦‚æ‹¬")]),s._v(" "),n("p",[s._v("1.åˆå§‹åŒ–å‚æ•°ï¼ˆå¾—åˆ°å‚æ•°ï¼‰ï¼š")]),s._v(" "),n("p",[s._v("ä»é…ç½®æ–‡ä»¶ï¼ˆwebpack.config.jsï¼‰ä¸­ä¸ shell è¯­å¥ä¸­è¯»å–ä¸åˆå¹¶å‚æ•°ï¼Œå¾—å‡ºæœ€ç»ˆçš„å‚æ•°ã€‚")]),s._v(" "),n("p",[s._v("2.å¼€å§‹ç¼–è¯‘ï¼š")]),s._v(" "),n("p",[s._v("ç”¨ä¸Šä¸€æ­¥ä¸­çš„å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ– Compiler å¯¹è±¡ï¼ŒåŠ è½½æ‰€æœ‰é…ç½®æ’ä»¶ï¼Œé€šè¿‡æ‰§è¡Œå¯¹è±¡çš„ run æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘ ã€‚")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v('new Compiler(åˆå§‹åŒ–å¾—åˆ°çš„æœ€ç»ˆå‚æ•°)ï¼›\n\n//é€šè¿‡apply åŠ è½½æ‰€æœ‰é…ç½®æ’ä»¶\nfor (const plugin of options.plugins) {\n\t\t\t// æ‰§è¡Œè‡ªå®šä¹‰æ’ä»¶\n\t\t\t\tif (typeof plugin === "function") {\n\t\t\t\t\tplugin.call(compiler, compiler);\n\t\t\t\t} else {\n\t\t\t\t\n\t\t\t\t\tplugin.apply(compiler);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n//æ‰§è¡Œå¯¹è±¡çš„run æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘\ncompiler.run(callback);\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("3.ç¡®å®šå…¥å£ï¼š")]),s._v(" "),n("p",[s._v("æ ¹æ®é…ç½®ä¸­çš„ entry æ‰¾å‡ºæ‰€æœ‰å…¥å£æ–‡ä»¶ ã€‚")]),s._v(" "),n("p",[s._v("WebpackOptionsApply -> EntryOptionPlugin ->SingleEntryPlugin")]),s._v(" "),n("p",[s._v("4.ç¼–è¯‘æ¨¡å—:\nä»å…¥å£æ–‡ä»¶å‡ºå‘ï¼Œå¼€å§‹ compilation è¿‡ç¨‹ï¼Œè°ƒç”¨æ‰€æœ‰é…ç½®çš„ Loader å¯¹æ¨¡å—è¿›è¡Œç¿»è¯‘ï¼Œå†å°†ç¼–è¯‘å¥½çš„æ–‡ä»¶å†…å®¹è§£ææˆ AST é™æ€è¯­æ³•æ ‘ï¼Œå†æ‰¾å‡ºè¯¥\næ¨¡å—ä¾èµ–çš„æ¨¡å—ï¼Œå†é€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡äº†æœ¬æ­¥éª¤çš„å¤„ç† ã€‚")]),s._v(" "),n("p",[s._v("5.å®Œæˆæ¨¡å—ç¼–è¯‘")]),s._v(" "),n("p",[s._v("ç»è¿‡ç¬¬ 4 æ­¥ä½¿ç”¨ Loader ç¿»è¯‘å®Œæ‰€æœ‰æ¨¡å—åï¼Œç”Ÿæˆ AST è¯­æ³•æ ‘ï¼Œåœ¨ AST è¯­æ³•æ ‘ä¸­å¯ä»¥åˆ†æåˆ°æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¯¹åº”åšå‡ºä¼˜åŒ–ã€‚")]),s._v(" "),n("p",[s._v("6.è¾“å‡ºèµ„æº")]),s._v(" "),n("p",[s._v("å°†æ‰€æœ‰æ¨¡å—ä¸­çš„ require è¯­æ³•æ›¿æ¢æˆ__webpack_require__æ¥æ¨¡æ‹Ÿæ¨¡å—åŒ–æ“ä½œã€‚")]),s._v(" "),n("p",[s._v("7.æœ€åæŠŠæ‰€æœ‰çš„æ¨¡å—æ‰“åŒ…è¿›ä¸€ä¸ªè‡ªæ‰§è¡Œå‡½æ•°ï¼ˆIIFEï¼‰ä¸­ã€‚")]),s._v(" "),n("h3",{attrs:{id:"æµç¨‹å›¾"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æµç¨‹å›¾"}},[s._v("#")]),s._v(" æµç¨‹å›¾")]),s._v(" "),n("p",[s._v("è¿™å¼ å›¾ç”»çš„å¾ˆå¥½ï¼ŒæŠŠ webpack çš„æµç¨‹ç”»çš„å¾ˆç»†è‡´ã€‚")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://wendaoshuai66.github.io/study/note/images/webpack_%E6%B5%81%E7%A8%8B%E5%9B%BE.png",alt:""}})]),s._v(" "),n("h2",{attrs:{id:"ç¼–å†™æ’ä»¶"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–å†™æ’ä»¶"}},[s._v("#")]),s._v(" ç¼–å†™æ’ä»¶")]),s._v(" "),n("h3",{attrs:{id:"ä¸€ä¸ªæœ€åŸºç¡€çš„-plugin-çš„ä»£ç æ˜¯è¿™æ ·çš„"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ä¸ªæœ€åŸºç¡€çš„-plugin-çš„ä»£ç æ˜¯è¿™æ ·çš„"}},[s._v("#")]),s._v(" ä¸€ä¸ªæœ€åŸºç¡€çš„ Plugin çš„ä»£ç æ˜¯è¿™æ ·çš„")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v('class basePlugin {\n    constructor(options){\n        //ç”¨æˆ·è‡ªå®šä¹‰é…ç½®\n        this.options = options\n        console.log(this.options)\n    }\n    apply(compiler) {\n        console.log("This is my first plugin.")\n    }\n}\n\nmodule.exports = basePlugin\n\n\nconst BasicPlugin =require (â€™./BasicPlugå·¥n. j s â€™); \nmodule.export = {\n\n    plugins:[\n     new. BasicPlugin();\n    ]\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("p",[s._v("Webpack å¯åŠ¨å")]),s._v(" "),n("p",[s._v("1.åœ¨è¯»å–é…ç½®çš„è¿‡ç¨‹ä¸­ä¼šå…ˆæ‰§è¡Œ new BasicPlugin(options )ï¼Œåˆå§‹åŒ–ä¸€ä¸ª BasicPlugin å¹¶è·å¾—å…¶å®ä¾‹ã€‚\n2.åœ¨åˆå§‹åŒ– compiler å¯¹è±¡åï¼Œ")]),s._v(" "),n("p",[s._v("3.å†è°ƒç”¨ basicPlugin.apply (compiler)ä¸ºæ’ä»¶å®ä¾‹ä¼ å…¥ compiler å¯¹è±¡ã€‚")]),s._v(" "),n("p",[s._v("4.æ’ä»¶å®ä¾‹åœ¨è·å–åˆ° compiler å¯¹è±¡åï¼Œ å°±å¯ä»¥é€šè¿‡ compiler.plugin (äº‹ä»¶åç§°ï¼Œå›è°ƒå‡½æ•°)ç›‘å¬åˆ° Webpack å¹¿æ’­çš„äº‹ä»¶ï¼Œ å¹¶ä¸”å¯ä»¥é€šè¿‡ compiler å¯¹è±¡å»æ“ä½œ Webpack.")]),s._v(" "),n("p",[s._v("è¿™å°±æ˜¯æœ€ç®€å•çš„ PluginğŸ˜Šï¼Œ ä½†åœ¨å®é™…å¼€å‘ä¸­è¿˜ æœ‰å¾ˆå¤šç»†èŠ‚éœ€è¦æ³¨æ„ ï¼Œä¸‹é¢è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚")]),s._v(" "),n("h3",{attrs:{id:"åˆ°åº•-compiler-å’Œ-compilation-æ˜¯ä»€ä¹ˆ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆ°åº•-compiler-å’Œ-compilation-æ˜¯ä»€ä¹ˆ"}},[s._v("#")]),s._v(" åˆ°åº• Compiler å’Œ Compilation æ˜¯ä»€ä¹ˆ")]),s._v(" "),n("p",[s._v("å¼€å‘ Plugin æ—¶æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå¯¹è±¡å°±æ˜¯ Compiler å’Œ Compilationï¼Œå®ƒä»¬æ˜¯ Plugin å’Œ Webpack\nä¹‹é—´çš„æ¡¥æ¢ã€‚ Compiler å’Œ Compilation çš„å«ä¹‰å¦‚ä¸‹ã€‚")]),s._v(" "),n("p",[s._v("Compiler å¯¹è±¡åŒ…å«äº† Webpack ç¯å¢ƒçš„æ‰€æœ‰é…ç½®ä¿¡æ¯ï¼ŒåŒ…å« optionsã€loadersã€plugins ç­‰ä¿¡æ¯ã€‚è¿™ä¸ªå¯¹è±¡åœ¨ Webpack å¯åŠ¨æ—¶è¢«å®ä¾‹åŒ–ï¼Œå®ƒæ˜¯å…¨å±€å”¯ä¸€çš„ï¼Œå¯ä»¥ç®€å•åœ°å°† å®ƒç†è§£ä¸º Webpack å®ä¾‹ã€‚")]),s._v(" "),n("p",[s._v("Compiler-----ã€‹ Webpack å®ä¾‹")]),s._v(" "),n("p",[s._v("Compilation å¯¹è±¡åŒ…å«äº†å½“å‰çš„æ¨¡å—èµ„æºã€ç¼–è¯‘ç”Ÿæˆèµ„æºã€å˜åŒ–çš„æ–‡ä»¶ç­‰ã€‚å½“ Webpack ä»¥å¼€å‘æ¨¡å¼è¿è¡Œæ—¶ï¼Œæ¯å½“æ£€æµ‹åˆ°ä¸€ä¸ªæ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œä¾¿æœ‰ä¸€æ¬¡æ–°çš„ Compilation è¢«\nåˆ›å»º ã€‚ Compilation å¯¹è±¡ä¹Ÿæä¾›äº†å¾ˆå¤šäº‹ä»¶å›è°ƒä¾›æ’ä»¶è¿›è¡Œæ‰©å±•ã€‚é€šè¿‡ Compilation ä¹Ÿèƒ½è¯»å–åˆ° Compiler å¯¹è±¡ã€‚")]),s._v(" "),n("p",[s._v("Compiler å’Œ Compilation çš„åŒºåˆ«åœ¨äº: Compiler ä»£è¡¨äº†æ•´ä¸ª Webpack ä»å¯åŠ¨åˆ°å…³é—­çš„ç”Ÿå‘½å‘¨æœŸï¼Œè€Œ Compilation åªä»£è¡¨ä¸€æ¬¡æ–°çš„ç¼–è¯‘ã€‚")]),s._v(" "),n("h3",{attrs:{id:"æ¸©ä¹ ä¸€ä¸‹-webpack-äº‹ä»¶æµ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ¸©ä¹ ä¸€ä¸‹-webpack-äº‹ä»¶æµ"}},[s._v("#")]),s._v(" æ¸©ä¹ ä¸€ä¸‹ webpack äº‹ä»¶æµ")]),s._v(" "),n("p",[s._v("webpack å°±åƒæ˜¯æˆ‘ä»¬å·¥å‚ä¸­æµæ°´çº¿ï¼Œè¦ç»è¿‡ä¸€ç³»åˆ—çš„æµç¨‹æ‰ä¼šæŠŠæˆ‘ä»¬çš„æºç è½¬åŒ–æˆè¾“å‡ºç»“æœ ã€‚åœ¨è¿™æ¡æµæ°´çº¿å½“ä¸­æ¯ä¸ªå¤„ç†æµç¨‹çš„èŒè´£éƒ½æ˜¯å•ä¸€çš„ï¼Œå¤šä¸ªæµç¨‹ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œåªæœ‰åœ¨å®Œæˆå½“å‰å¤„ç†åæ‰èƒ½æäº¤ç»™ä¸‹ä¸€ä¸ªæµç¨‹å»å¤„ç†ã€‚æ’ä»¶å°±åƒæ’å…¥ç”Ÿäº§çº¿ä¸­çš„æŸä¸ªåŠŸèƒ½ï¼Œåœ¨ç‰¹å®šçš„æ—¶æœºå¯¹ç”Ÿäº§çº¿ä¸Šçš„èµ„æºè¿›è¡Œå¤„ç†ã€‚")]),s._v(" "),n("p",[s._v("Webpack é€šè¿‡ Tapable "),n("a",{attrs:{href:"https://github.com/webpack/tapable",target:"_blank",rel:"noopener noreferrer"}},[s._v("(https://github.com/webpack/tapable)"),n("OutboundLink")],1),s._v("æ¥ç»„ç»‡è¿™æ¡å¤æ‚çš„æµæ°´çº¿ã€‚ Webpack åœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¼šå¹¿æ’­äº‹ä»¶ï¼Œæ’ä»¶åªéœ€è¦ç›‘å¬å®ƒæ‰€å…³å¿ƒçš„äº‹ä»¶ï¼Œå°±èƒ½åŠ å…¥è¿™æ¡ç”Ÿäº§çº¿ä¸­ï¼Œå»æ”¹å˜æµæ°´çº¿çš„è¿ä½œã€‚ Webpack çš„äº‹ä»¶æµæœºåˆ¶ä¿è¯äº†æ’ä»¶çš„æœ‰åºæ€§ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿçš„æ‰©å±•æ€§è‰¯å¥½ã€‚")]),s._v(" "),n("p",[s._v("Webpack çš„äº‹ä»¶æµæœºåˆ¶åº”ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå’Œ Node æ‰£ä¸­çš„ EventEmitter éå¸¸ç›¸ä¼¼ ã€‚Compiler å’Œ Compilation éƒ½ç»§æ‰¿è‡ª Tapableï¼Œå¯ä»¥ç›´æ¥åœ¨ Compiler å’Œ Compilation å¯¹è±¡ä¸Šå¹¿æ’­å’Œç›‘æ˜•äº‹ ä»¶ï¼Œæ–¹æ³•å¦‚ä¸‹:")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v("/**\n*å¹¿æ’­äº‹ä»¶\né£Ÿ event-name ä¸ºäº‹ä»¶åç§°ï¼Œæ³¨æ„ä¸è¦å’Œç°æœ‰çš„äº‹ä»¶é‡å * params ä¸ºé™„å¸¦çš„å‚æ•°\n*/\ncompiler.apply â€™event-nameâ€™, params);\n/**\n*ç›‘æ˜•åç§°ä¸º event-name çš„äº‹ä»¶ï¼Œå½“ event-name äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œ ã€‚ *åŒæ—¶å‡½æ•°ä¸­çš„ params å‚æ•°ä¸ºå¹¿æ’­äº‹ä»¶æ—¶é™„å¸¦çš„å‚æ•° ã€‚\n*/\ncompiler.plugin (â€™event-nameâ€™, function (params) {\n\n} ) ,\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v("class SyncHook{\n    constructor(){\n        this.hooks = {}\n    }\n\n    // è®¢é˜…äº‹ä»¶\n    tap(name, fn){\n    \n        this.hooks[name] = [fn]\n    }\n\n    // å‘å¸ƒ\n    call(){\n        this.hooks[name].forEach(fn=>fn())\n    }\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h3",{attrs:{id:"å®æˆ˜å‰–æ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å®æˆ˜å‰–æ"}},[s._v("#")]),s._v(" å®æˆ˜å‰–æ")]),s._v(" "),n("p",[s._v("æ¥çœ‹ä¸€çœ‹å·²ç»è¢«ä¼—äººç©åçš„ html-webpack-plugin")]),s._v(" "),n("div",{staticClass:"language-plain line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-plain"}},[n("code",[s._v("const pluginName = 'ConsoleLogOnBuildWebpackPlugin';\n\n\nlet assetsHelp = (data) => {\n    let js = [];\n    let css = [];\n    let dir = {\n        js: item => `<script src=\"${item}\" class=\"lazyload-js\" type=\"module\"><\/script>`,\n        css: item => `<link rel=\"stylesheet\" href=\"${item}\">`\n    }\n    for (let jsitem of data.js) {\n        js.push(dir.js(jsitem))\n    }\n    for (let cssitem of data.css) {\n        css.push(dir.js(cssitem))\n    }\n    return {\n        js,\n        css\n    }\n}\n\n\nclass ConsoleLogOnBuildWebpackPlugin {\n    apply(compiler) {\n        compiler.hooks.compilation.tap(pluginName, compilation => {\n\n            compilation.hooks.htmlWebpackPluginAfterHtmlProcessing.tap(pluginName, (webpackPluginData) => {\n                console.log('ğŸğŸğŸğŸğŸ', webpackPluginData.assets)\n                let _html = webpackPluginData.html;\n                let result = assetsHelp(webpackPluginData.assets)\n                _html = _html.replace(/@components/g, '../../../components');\n                _html = _html.replace('\x3c!--injectjs--\x3e', result.js.join(''));\n                _html = _html.replace('\x3c!--injectcss--\x3e', result.css.join(''));\n                webpackPluginData.html = _html;\n            })\n        });\n\n    }\n}\nmodule.exports = ConsoleLogOnBuildWebpackPlugin;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);