<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack ä½¿ç”¨æ€»ç»“ | å‰ç«¯æ—¥å¿—</title>
    <meta name="description" content="æ¬¢è¿è®¿é—®æˆ‘çš„å‰ç«¯æ—¥å¿—">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/hero.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.f48a6bab.css" as="style"><link rel="preload" href="/assets/js/app.7db32d51.js" as="script"><link rel="preload" href="/assets/js/2.1f0a0a54.js" as="script"><link rel="preload" href="/assets/js/28.fc75bc52.js" as="script"><link rel="prefetch" href="/assets/js/10.8bcbf328.js"><link rel="prefetch" href="/assets/js/11.98cbf51b.js"><link rel="prefetch" href="/assets/js/12.6f2040f7.js"><link rel="prefetch" href="/assets/js/13.cfc0ecb9.js"><link rel="prefetch" href="/assets/js/14.78a613d7.js"><link rel="prefetch" href="/assets/js/15.ce8a7d53.js"><link rel="prefetch" href="/assets/js/16.856a74ca.js"><link rel="prefetch" href="/assets/js/17.64e3fa34.js"><link rel="prefetch" href="/assets/js/18.3e7ddfff.js"><link rel="prefetch" href="/assets/js/19.2dee6f08.js"><link rel="prefetch" href="/assets/js/20.1d99c2cc.js"><link rel="prefetch" href="/assets/js/21.067f638b.js"><link rel="prefetch" href="/assets/js/22.e2b7fa3a.js"><link rel="prefetch" href="/assets/js/23.26b7cc38.js"><link rel="prefetch" href="/assets/js/24.d180d5c5.js"><link rel="prefetch" href="/assets/js/25.3694e56c.js"><link rel="prefetch" href="/assets/js/26.4adf545a.js"><link rel="prefetch" href="/assets/js/27.5360046e.js"><link rel="prefetch" href="/assets/js/29.5992374f.js"><link rel="prefetch" href="/assets/js/3.4da69777.js"><link rel="prefetch" href="/assets/js/30.88906c2f.js"><link rel="prefetch" href="/assets/js/31.7b9217a6.js"><link rel="prefetch" href="/assets/js/32.bf017485.js"><link rel="prefetch" href="/assets/js/33.f4d745c7.js"><link rel="prefetch" href="/assets/js/34.8458c3b8.js"><link rel="prefetch" href="/assets/js/35.db879782.js"><link rel="prefetch" href="/assets/js/36.0f635906.js"><link rel="prefetch" href="/assets/js/37.7d8dcb7a.js"><link rel="prefetch" href="/assets/js/38.6ff78b15.js"><link rel="prefetch" href="/assets/js/39.e8711a2c.js"><link rel="prefetch" href="/assets/js/4.4379ec61.js"><link rel="prefetch" href="/assets/js/40.182f2dcf.js"><link rel="prefetch" href="/assets/js/41.0ce7c377.js"><link rel="prefetch" href="/assets/js/42.0208ef5f.js"><link rel="prefetch" href="/assets/js/43.beceba14.js"><link rel="prefetch" href="/assets/js/44.6779228d.js"><link rel="prefetch" href="/assets/js/45.20b1abd2.js"><link rel="prefetch" href="/assets/js/46.ddc68fa1.js"><link rel="prefetch" href="/assets/js/47.b7479d5c.js"><link rel="prefetch" href="/assets/js/48.46413833.js"><link rel="prefetch" href="/assets/js/49.b9a3878a.js"><link rel="prefetch" href="/assets/js/5.c37a0a9f.js"><link rel="prefetch" href="/assets/js/50.6f312b15.js"><link rel="prefetch" href="/assets/js/51.3e8a26ff.js"><link rel="prefetch" href="/assets/js/52.32fe43d9.js"><link rel="prefetch" href="/assets/js/53.60b5f0aa.js"><link rel="prefetch" href="/assets/js/54.a04de6c7.js"><link rel="prefetch" href="/assets/js/55.41724eea.js"><link rel="prefetch" href="/assets/js/56.255fb40a.js"><link rel="prefetch" href="/assets/js/57.f8c15ae2.js"><link rel="prefetch" href="/assets/js/58.501812a4.js"><link rel="prefetch" href="/assets/js/59.b288577c.js"><link rel="prefetch" href="/assets/js/6.bce38e64.js"><link rel="prefetch" href="/assets/js/7.aa4106f1.js"><link rel="prefetch" href="/assets/js/8.30b1c27a.js"><link rel="prefetch" href="/assets/js/9.9129683e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f48a6bab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">å‰ç«¯æ—¥å¿—</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">
  åšå®¢
</a></div> <a href="https://github.com/wendaoshuai66/blogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">
  åšå®¢
</a></div> <a href="https://github.com/wendaoshuai66/blogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‰ç«¯åŸºç¡€</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/unknowHtml1.html" class="sidebar-link">ä½ ä¸çŸ¥é“çš„ HTML</a></li><li><a href="/blog/cssnote.html" class="sidebar-link">CSS ç®€ä»‹åŠå®ç”¨æŠ€å·§</a></li><li><a href="/blog/3d.html" class="sidebar-link">CSS3 æ„é€  3D ä¸–ç•Œ</a></li><li><a href="/blog/jsFunctionalProgramming_bottom.html" class="sidebar-link">JavaScript å‡½æ•°å¼ç¼–ç¨‹--ä¸‹</a></li><li><a href="/blog/jsFunctionalProgramming.html" class="sidebar-link">JavaScript å‡½æ•°å¼ç¼–ç¨‹--ä¸Š</a></li><li><a href="/blog/å‰ç«¯ä¸­ç»å¸¸å‡ºç°çš„é”™è¯¯åŠæ•è·.html" class="sidebar-link">å‰ç«¯ä¸­ç»å¸¸å‡ºç°çš„é”™è¯¯åŠæ•è·</a></li><li><a href="/blog/æ·±æ‹·è´.html" class="sidebar-link">å¯¹æ·±æ‹·è´çš„ç ”ç©¶</a></li><li><a href="/blog/Promise.html" class="sidebar-link">Promise</a></li><li><a href="/blog/php_up.html" class="sidebar-link">PHP ä¸ MySQL å¼€å‘å…¥é—¨ä¸Š</a></li><li><a href="/blog/php_middle.html" class="sidebar-link">Php ä¸ MySql å¼€å‘å…¥é—¨ä¸­</a></li><li><a href="/blog/php_down.html" class="sidebar-link">Php ä¸ MySql å¼€å‘å…¥é—¨ä¸‹</a></li><li><a href="/blog/ES5_top.html" class="sidebar-link">ECMAScript5.1 æ–°å¢è¯­æ³•ä¸Š</a></li><li><a href="/blog/ES5_bottom.html" class="sidebar-link">ECMAScript5.1 æ–°å¢è¯­æ³•ä¸‹</a></li><li><a href="/blog/ES5_core.html" class="sidebar-link">ES5 çš„æ ¸å¿ƒæŠ€æœ¯</a></li><li><a href="/blog/ES5_core1.html" class="sidebar-link">ä¸çŸ¥é“çš„ JavaScript</a></li><li><a href="/blog/JavaScriptæ‰§è¡Œå †æ ˆæ¢ç´¢.html" class="sidebar-link">JavaScript æ‰§è¡Œå †æ ˆæ¢ç´¢</a></li><li><a href="/blog/Interview.html" class="sidebar-link">é¢è¯•é¢˜ç§¯ç´¯ 1</a></li><li><a href="/blog/é¢å‘åˆ‡é¢.html" class="sidebar-link">é¢å‘åˆ‡é¢åˆæ¢</a></li><li><a href="/blog/system.html" class="sidebar-link">åˆæ¢ System.js</a></li><li><a href="/blog/å‰ç«¯æ¶æ„ä¸æ€§èƒ½ä¼˜åŒ–é‚£äº›äº‹.html" class="sidebar-link">å‰ç«¯æ¶æ„ä¸æ€§èƒ½ä¼˜åŒ–é‚£äº›äº‹</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å‰ç«¯æ¡†æ¶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vueåŸç†è§£æä¹‹å‡†å¤‡å·¥ä½œ.html" class="sidebar-link">vue åŸç†è§£æä¹‹å‡†å¤‡å·¥ä½œ</a></li><li><a href="/blog/vueåŸç†è§£æä¹‹æ•°æ®é©±åŠ¨.html" class="sidebar-link">vue åŸç†è§£æä¹‹æ•°æ®é©±åŠ¨</a></li><li><a href="/blog/vueåŸç†è§£æä¹‹ç¼–è¯‘æ·±å…¥.html" class="sidebar-link">vue åŸç†è§£æä¹‹ç¼–è¯‘æ·±å…¥</a></li><li><a href="/blog/vueåŸç†è§£æä¹‹å“åº”å¼åŸç†æ·±å…¥.html" class="sidebar-link">vue åŸç†è§£æä¹‹å“åº”å¼åŸç†æ·±å…¥</a></li><li><a href="/blog/ç®€å•çš„å®ç°Vueä¹‹å“åº”å¼.html" class="sidebar-link">ç®€å•çš„å®ç° Vue ä¹‹å“åº”å¼</a></li><li><a href="/blog/vueåŸç†è§£æä¹‹nextTickæ¢ç´¢.html" class="sidebar-link">vue åŸç†è§£æä¹‹ nextTick æ¢ç´¢</a></li><li><a href="/blog/Webpack.html" class="sidebar-link">å¸¸ç”¨çš„å‰ç«¯æ„å»ºå·¥å…·-Webpack</a></li><li><a href="/blog/Webpackä½¿ç”¨æ€»ç»“.html" class="active sidebar-link">Webpack ä½¿ç”¨æ€»ç»“</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/Webpackä½¿ç”¨æ€»ç»“.html#å‰ç«¯çš„å‘å±•" class="sidebar-link">å‰ç«¯çš„å‘å±•</a></li><li class="sidebar-sub-header"><a href="/blog/Webpackä½¿ç”¨æ€»ç»“.html#æ•´ä½“æµç¨‹åˆ†æ" class="sidebar-link">æ•´ä½“æµç¨‹åˆ†æ</a></li><li class="sidebar-sub-header"><a href="/blog/Webpackä½¿ç”¨æ€»ç»“.html#webpack-æ•´ä½“æµç¨‹åˆ†ææ€»ç»“" class="sidebar-link">webpack æ•´ä½“æµç¨‹åˆ†ææ€»ç»“</a></li><li class="sidebar-sub-header"><a href="/blog/Webpackä½¿ç”¨æ€»ç»“.html#ç¼–å†™æ’ä»¶" class="sidebar-link">ç¼–å†™æ’ä»¶</a></li></ul></li><li><a href="/blog/Webpackç³»åˆ—æ‰‹å†™æ¨¡å—æ‰“åŒ…ä»£ç .html" class="sidebar-link">Webpack ç³»åˆ—æ‰‹å†™æ¨¡å—æ‰“åŒ…ä»£ç </a></li><li><a href="/blog/Reactå…¥é—¨å¿…å­¦[ä¸Š].html" class="sidebar-link">React å…¥é—¨å¿…å­¦ã€ä¸Šã€‘</a></li><li><a href="/blog/Reactå…¥é—¨å¿…å­¦[ä¸‹].html" class="sidebar-link">React å…¥é—¨å¿…å­¦ã€ä¸‹ã€‘</a></li><li><a href="/blog/ReduxåŸç†.html" class="sidebar-link">æ¢ç´¢ Redux åŸç†</a></li><li><a href="/blog/TypeScriptä½¿ç”¨æ‰‹å†Œ.html" class="sidebar-link">TypeScript ä½¿ç”¨æ‰‹å†Œ</a></li><li><a href="/blog/NodeJSå…¥é—¨.html" class="sidebar-link">NodeJS å…¥é—¨</a></li><li><a href="/blog/NodeJSæ¡†æ¶å…¥é—¨.html" class="sidebar-link">NodeJs æ¡†æ¶å…¥é—¨</a></li><li><a href="/blog/NodeJSä½¿ç”¨çš„æ€»ç»“.html" class="sidebar-link">NodeJS ä½¿ç”¨çš„æ€»ç»“</a></li><li><a href="/blog/pm2é¡¹ç›®éƒ¨ç½²æ€»ç»“.html" class="sidebar-link">pm2 é¡¹ç›®éƒ¨ç½²æ€»ç»“</a></li><li><a href="/blog/KOAæºç çš„é˜…è¯».html" class="sidebar-link">KOA æºç çš„é˜…è¯»</a></li><li><a href="/blog/æ·±å…¥KoaåŸç†.html" class="sidebar-link">æ·±å…¥ Koa åŸç†</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‰ç«¯æµ‹è¯•</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/js_and_qa.html" class="sidebar-link">JavaScript ä¸ QA æµ‹è¯•å·¥ç¨‹å¸ˆ</a></li><li><a href="/blog/tegratedTesting.html" class="sidebar-link">JavaScript é›†æˆåŒ–æµ‹è¯•</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‰ç«¯å·¥å…·</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/ä¸ºä»€ä¹ˆè¦ä½¿ç”¨package-lock.json.html" class="sidebar-link">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ package-lock.json</a></li><li><a href="/blog/Package.jsonä¾èµ–ç®¡ç†.html" class="sidebar-link">Package.json ä¾èµ–ç®¡ç†</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>è®¡ç®—æœºç½‘ç»œ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/httpåè®®.html" class="sidebar-link">HTPP åè®®é‚£äº›äº‹</a></li><li><a href="/blog/server-po.html" class="sidebar-link">å‰ç«¯æ€§èƒ½ä¼˜åŒ–å¿…å¤‡æœåŠ¡å™¨çŸ¥è¯†</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ“ä½œç³»ç»Ÿ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/Linux.html" class="sidebar-link">Linux åŸºç¡€å…¥é—¨</a></li><li><a href="/blog/Linux_supplement.html" class="sidebar-link">Linux è¡¥å……</a></li><li><a href="/blog/Linux_web.html" class="sidebar-link">Linux ä¸­é…ç½®é™æ€ç½‘ç»œè¿æ¥</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ•°æ®ç»“æ„ä¸ç®—æ³•</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/å‰ç«¯ä¸­çš„æ•°æ®ç»“æ„-æ’åº.html" class="sidebar-link">å‰ç«¯ä¸­çš„æ•°æ®ç»“æ„-æ’åº</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ‚è°ˆ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/æ‚è°ˆ.html" class="sidebar-link">åå°è¯­è¨€</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å¼€å‘</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/å®æˆ˜1æ­¥éª¤è¯¦è§£.html" class="sidebar-link">å®æˆ˜ï¼šæ‰‹æ­ä¸€ä¸ª Reactï¼ŒTypescriptï¼ŒKoaï¼ŒGraphQL ç¯å¢ƒ</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack-ä½¿ç”¨æ€»ç»“"><a href="#webpack-ä½¿ç”¨æ€»ç»“" class="header-anchor">#</a> Webpack ä½¿ç”¨æ€»ç»“</h1> <h2 id="å‰ç«¯çš„å‘å±•"><a href="#å‰ç«¯çš„å‘å±•" class="header-anchor">#</a> å‰ç«¯çš„å‘å±•</h2> <p>è¿‘å¹´æ¥ Web åº”ç”¨å˜å¾—æ›´åŠ å¤æ‚ä¸åºå¤§ï¼Œ Web å‰ç«¯æŠ€æœ¯çš„åº”ç”¨èŒƒå›´ä¹Ÿæ›´åŠ å¹¿æ³›ã€‚é€šè¿‡ç›´æ¥ç¼–å†™ JavaScriptã€cssã€ HTML å¼€å‘ Web åº”ç”¨çš„æ–¹å¼å·±ç»æ— æ³•åº”å¯¹å½“å‰ Web åº”ç”¨çš„å‘å±• ã€‚ è¿‘å¹´æ¥ï¼Œå‰ç«¯ç¤¾åŒºæ¶Œç°å‡º è®¸ å¤šæ–°æ€æƒ³ä¸æ¡†æ¶ï¼Œä¸‹é¢å°†ä¸€ä¸€ä»‹ç»å®ƒ ä»¬ ã€‚</p> <h3 id="æ¨¡å—åŒ–"><a href="#æ¨¡å—åŒ–" class="header-anchor">#</a> æ¨¡å—åŒ–</h3> <p>æ¨¡å—åŒ–æ˜¯æŒ‡å°†ä¸€ä¸ªå¤æ‚çš„ç³»ç»Ÿåˆ†è§£ä¸ºå¤šä¸ªæ¨¡å—ï¼Œæ–¹ä¾¿ç¼–ç </p> <p>å¾ˆä¹…ä»¥å‰ï¼Œå¼€å‘ç½‘é¡µè¦é€šè¿‡å‘½åç©ºé—´çš„æ–¹å¼æ¥ç»„ç»‡ä»£ç ï¼Œä¾‹å¦‚ jQuery åº“å°†å®ƒçš„ API éƒ½æ”¾ åœ¨äº† window .$ä¸‹ï¼Œåœ¨åŠ è½½å®Œ jQue ç”ºåï¼Œå…¶ä»–æ¨¡å—å†é€šè¿‡ window . â™€å»ä½¿ç”¨ jQueryã€‚è¿™æ ·åš æœ‰å¾ˆå¤šé—®é¢˜ï¼Œå…¶ä¸­åŒ…æ‹¬:</p> <p>å‘½åç©ºé—´å†²çªï¼Œä¸¤ä¸ªåº“å¯èƒ½ä¼šä½¿ç”¨åŒä¸€ä¸ªåç§°ï¼Œä¾‹å¦‚ Zepto (http://zeptojs.com)ä¹Ÿ è¢«æ”¾åœ¨ w å·¥ ndow.$ä¸‹</p> <p>æ— æ³•åˆç†åœ°ç®¡ç†é¡¹ç›®çš„ä¾èµ–å’Œç‰ˆæœ¬</p> <p>æ— æ³•æ–¹ä¾¿åœ°æ§åˆ¶ä¾èµ–çš„åŠ è½½é¡ºåºã€‚</p> <p>ç›´ç™½ä¸€äº›å°±æ˜¯å¼€å‘æ•ˆç‡ä¼šä½ï¼Œç»´æŠ¤æˆæœ¬ä¼šå¤§ã€‚</p> <h4 id="commonjs"><a href="#commonjs" class="header-anchor">#</a> CommonJS</h4> <p>CommonJS æ˜¯ä¸€ç§å¹¿æ³›åº”ç”¨çš„ Javascript æ¨¡å—åŒ–è§„èŒƒï¼Œæ ¸å¿ƒï¼š</p> <p>require æ–¹æ³•åŒæ­¥åŠ è½½ä¾èµ–çš„å…¶ä»–æ¨¡å—ï¼Œ</p> <p>module.exports å¯¼å‡ºéœ€è¦çš„æ¥å£</p> <p>CommonJS çš„æµè¡Œ çš„ç›Šäº node é‡‡ç”¨è¯¥æ–¹å¼ï¼Œåæ¥è¿™ç§æ–¹å¼è¢«å¼•å…¥åˆ°ç½‘é¡µä¸­å¼€å‘</p> <p>é‡‡ç”¨ CommonJS å¯¼å…¥åŠå¯¼å‡ºçš„ä»£ç å¦‚ä¸‹:</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>// å¯¼å…¥
const moduleA = require ( â€™. / moduleA â€™); // å¯¼å‡º
module .exports = moduleA.someFunc;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>CommonJS çš„ä¼˜ç‚¹åœ¨äº:</p> <p>1.ä»£ç å¯å¤ç”¨äº Node.js ç¯å¢ƒä¸­ï¼Œä¾‹å¦‚åšåŒæ„</p> <p>2.é€šè¿‡ npm å‘å¸ƒçš„å¾ˆå¤šç¬¬ä¸‰æ–¹æ¨¡å—éƒ½é‡‡ç”¨äº†ï¼ŒCommonJS è§„èŒƒã€‚</p> <p>ç¼ºç‚¹ï¼š</p> <p>1.ä¸èƒ½ç›´æ¥åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­è¿è¡Œï¼Œå¿…é¡»é€šè¿‡å·¥å…·è½¬æ¢ä¸º ES5 çš„æ ‡å‡†</p> <p>å†å²</p> <p>CommonJS è¿˜å¯ä»¥ç»†åˆ†ä¸º CommonJSl å’Œ CommonJS2</p> <p>CommonJS1 å’Œ CommonJS2 åŒºåˆ«ï¼š</p> <p>CommonJS1 åªèƒ½é€šè¿‡ exports . XX = XX å¯¼å‡º</p> <p>CommonJS2 åœ¨ CommonJSl çš„åŸºç¡€ä¸ŠåŠ å…¥äº† module. exports = XX</p> <h4 id="amd"><a href="#amd" class="header-anchor">#</a> AMD</h4> <p>AMD ä¹Ÿæ˜¯ä¸€ç§ JavaScript æ¨¡å—åŒ–è§„èŒƒã€‚</p> <p>AMD ä¸ CommonJS åŒºåˆ«ï¼šAMD é‡‡ç”¨äº†å¼‚æ­¥çš„æ–¹å¼å»åŠ è½½ä¾èµ–çš„æ¨¡å—ã€‚</p> <p>AMD ä¸»è¦ç”¨äºè§£å†³é’ˆå¯¹æµè§ˆå™¨ç¯å¢ƒçš„æ¨¡å—åŒ–é—®é¢˜ï¼Œæœ€å…·ä»£è¡¨æ€§çš„å®ç°æ˜¯ requirejsã€‚</p> <p>é‡‡ç”¨ AMD å¯¼å…¥åŠå¯¼å‡ºçš„ä»£ç å¦‚ä¸‹:</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>é‡‡ç”¨ AMD å¯¼å…¥åŠå¯¼å‡ºçš„ä»£ç å¦‚ä¸‹:
// å®šä¹‰ä¸€ä¸ªæ¨¡å—
define (â€™ module â€™ , [ â€™ dep â€™] , function (dep) {
requirejs
(http://
return exports;
});
//å¯¼å…¥å’Œä½¿ç”¨
require ([â€™moduleâ€™] , });
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>AMD çš„ä¼˜ç‚¹åœ¨äº:</p> <p>1.å¯åœ¨ä¸è½¬æ¢ä»£ç çš„æƒ…å†µä¸‹ç›´æ¥åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­è¿è¡Œ</p> <p>2.å¼‚æ­¥åŠ è½½ä¾èµ–</p> <p>3.å¯ä»¥å¹¶è¡ŒåŠ è½½å¤šä¸ªä¾èµ–</p> <p>4.ä»£ç å¯ä»¥åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ä¸ Node ç¯å¢ƒä¸­è¿è¡Œ</p> <p>AMD çš„ä¼˜ç‚¹åœ¨äº:</p> <p>JavaScript è¿è¡Œç¯å¢ƒæ²¡æœ‰åŸç”Ÿæ”¯æŒ AMDã€‚ï¼Œ éœ€è¦å…ˆå¯¼å…¥å®ç°äº† AMD çš„åº“ åæ‰èƒ½æ­£å¸¸ä½¿ç”¨ã€‚</p> <h4 id="es6-æ¨¡å—åŒ–"><a href="#es6-æ¨¡å—åŒ–" class="header-anchor">#</a> ES6 æ¨¡å—åŒ–</h4> <p>ES6 æ¨¡å—åŒ–æ˜¯å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ ECMA æå‡ºçš„ JavaScript æ¨¡å—åŒ–è§„èŒƒï¼Œå®ƒåœ¨ è¯­è¨€å±‚é¢ä¸Šå® ç°äº†æ¨¡å—åŒ–ã€‚æµè§ˆå™¨å‚å•†å’Œ Node. éƒ½å®£å¸ƒè¦åŸç”Ÿæ”¯æŒè¯¥è§„èŒƒ ã€‚ å®ƒå°†é€æ¸å–ä»£ CommonJS å’Œ AMD è§„èŒƒï¼Œæˆä¸ºæµè§ˆå™¨å’ŒæœåŠ¡å™¨é€šç”¨çš„æ¨¡å—è§£å†³æ–¹æ¡ˆ ã€‚</p> <p>é‡‡ç”¨ ES6 æ¨¡å—åŒ–å¯¼å…¥åŠå¯¼å‡ºçš„ä»£ç å¦‚ä¸‹:</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>//å¯¼ å…¥
import { readFile } from â€™ fs â€™; import React from â€™reactâ€™; //å¯¼å‡º
export function hello {) {};

export default {

...
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="å¸¸è§çš„æ„å»ºå·¥å…·åŠå¯¹æ¯”"><a href="#å¸¸è§çš„æ„å»ºå·¥å…·åŠå¯¹æ¯”" class="header-anchor">#</a> å¸¸è§çš„æ„å»ºå·¥å…·åŠå¯¹æ¯”</h3> <h4 id="gulp"><a href="#gulp" class="header-anchor">#</a> Gulp</h4> <p>Gulp æ˜¯åŸºäºæµçš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ã€‚å¯ä»¥ç®¡ç†å’Œæ‰§è¡Œä»»åŠ¡ã€‚è¿˜å¯ä»¥æ”¯æŒç›‘å¬æ–‡ä»¶ï¼Œä¸è¯»å†™æ–‡ä»¶</p> <p>Gulp è¢«è®¾è®¡å¾—éå¸¸ç®€å•ï¼Œåªé€šè¿‡ä¸‹é¢ 5 ç§æ–¹æ³•å°±å¯ä»¥æ”¯æŒå‡ ä¹ æ‰€æœ‰æ„å»ºåœºæ™¯:</p> <p>1.gulp.task æ³¨å†Œä»»åŠ¡</p> <ol start="2"><li>gulp.run æ‰§è¡Œä»»åŠ¡</li></ol> <p>3.gulp.watch ç›‘å¬ä»»åŠ¡</p> <p>4.gulp.src è¯»å–æ–‡ä»¶</p> <p>5.gulp.dest å†™æ–‡ä»¶</p> <p>ä¸¾ä¸ªä¾‹å­ Gulp å’Œ Rollup å®ç°äº†å¯¹æ•°æ®çš„æµæ¸…æ´—</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>const gulp = require('gulp');
const watch = require('gulp-watch');
const rollup = require('gulp-rollup');
const babel = require('gulp-babel');
const replace = require('rollup-plugin-replace')
const entry = './src/server/**/*.js';
const clearEntry = [&quot;./src/server/config/index.js&quot;]


function buildenv() {
    return watch(entry, { ignoreInitial: false }, function() {
            gulp.src(entry)
                .pipe(babel({
                    //éå¸¸é‡è¦ä¸€ç‚¹ï¼Œæ¶‰åŠåˆ°è‡ªå·±ç‹¬ç«‹çš„ç¼–è¯‘ï¼Œå¤–é¢çš„ç•™ç»™å‰ç«¯
                    babelrc: false,
                    &quot;plugins&quot;: [
                        [&quot;@babel/plugin-proposal-decorators&quot;, { &quot;legacy&quot;: true }],
                        &quot;@babel/plugin-transform-modules-commonjs&quot;
                    ]
                })).pipe(gulp.dest('dist'))
        })
        // .pipe(gulp.dest('dist')); æ”¾å¤–é¢ç›‘æµ‹ä¸åˆ°ï¼Œæœ‰ç‚¹æ¯›ç—… ğŸ˜”

}
//ä¸å¼€å‘æ²¡æœ‰å¤šå¤§åŒºåˆ«ï¼Œåªä¸è¿‡è¦åŠ ä¸€ä¸ªæµå¼æ¸…æ´—
function buildprod() {

    return gulp.src(entry)
        .pipe(babel({
            //éå¸¸é‡è¦ä¸€ç‚¹ï¼Œæ¶‰åŠåˆ°è‡ªå·±ç‹¬ç«‹çš„ç¼–è¯‘ï¼Œå¤–é¢çš„ç•™ç»™å‰ç«¯
            babelrc: false,
            ignore: clearEntry,
            &quot;plugins&quot;: [
                [&quot;@babel/plugin-proposal-decorators&quot;, { &quot;legacy&quot;: true }],
                &quot;@babel/plugin-transform-modules-commonjs&quot;
            ]
        })).pipe(gulp.dest('dist'))
}

function buildconfig() {
    return gulp.src(entry)
        .pipe(rollup({
            //æ³¨æ„ä¸€ç‚¹è¦ç¼–è¯‘æˆcommonjs
            output: {
                format: &quot;cjs&quot;
            },
            input: clearEntry,
            //ç”±äºæ‰“åŒ…åï¼Œå¯¹process.env.NODE_ENVæ²¡æœ‰å¤„ç†
            plugins: [
                replace({
                    &quot;process.env.NODE_ENV&quot;: JSON.stringify('production')
                })
            ]
        }))
        .pipe(gulp.dest('./dist'));
}

function lint() {

}
let build = gulp.series(buildenv)

if (process.env.NODE_ENV == 'lint') {
    build = gulp.series(lint)
}
if (process.env.NODE_ENV == 'production') {
    build = gulp.series(buildprod, buildconfig)
}
gulp.task(&quot;default&quot;, build)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><h4 id="webpack"><a href="#webpack" class="header-anchor">#</a> Webpack</h4> <p>Webpack æ˜¯ä¸€ä¸ªæ‰“åŒ…æ¨¡å—åŒ– js çš„å·¥å…·ğŸ”§ï¼Œåœ¨ Webpack ä¸­ä¸€åˆ‡çš†æ¨¡å—ï¼Œé€šè¿‡ loader è½¬åŒ–æ–‡ä»¶ï¼Œé€šè¿‡ Plugin æ³¨å…¥é’©å­ï¼Œæœ€åè¾“å‡ºç”±å¤šä¸ªæ¨¡å—ç»„åˆæˆçš„æ–‡ä»¶ğŸ“ƒã€‚</p> <p>ä¸€åˆ‡æ–‡ä»¶å¦‚ JavaScriptã€ cssã€ scssã€å›¾ç‰‡ã€æ¨¡æ¿ï¼Œå¯¹äº Webpack æ¥è¯´éƒ½æ˜¯ä¸€ä¸ªä¸ªæ¨¡å—</p> <h4 id="rollup"><a href="#rollup" class="header-anchor">#</a> Rollup</h4> <p>Rollup (https://rollupjs.org)æ˜¯ä¸€ä¸ªå’Œ Webpack å¾ˆç±»ä¼¼ä½†ä¸“æ³¨äº ES6 çš„æ¨¡å—æ‰“åŒ…å·¥å…·ã€‚å®ƒ çš„äº®ç‚¹ åœ¨äºï¼Œèƒ½é’ˆå¯¹ ES6 æºç è¿›è¡Œ Tree Shakingï¼Œä»¥å»é™¤é‚£äº›å·±è¢«å®šä¹‰ä½†æ²¡è¢«ä½¿ç”¨çš„ä»£ç  å¹¶è¿› è¡Œ Scope Hoistingï¼Œä»¥å‡å°è¾“å‡º æ–‡ä»¶çš„å¤§ å°å’Œæå‡è¿è¡Œæ€§èƒ½ ã€‚ç„¶è€Œ Rollup çš„è¿™äº›äº®ç‚¹éšåå°±è¢« Webpack æ¨¡ä»¿å’Œå®ç°ã€‚ç”±äº Rollup çš„ä½¿ç”¨æ–¹æ³•å’Œ Webpack å·®ä¸å¤š ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸è¯¦ç»†ä»‹ç»å¦‚ ä½•ä½¿ç”¨ Rollup äº†ï¼Œè€Œæ˜¯è¯¦ç»†è¯´æ˜å®ƒä»¬çš„å·®åˆ«:</p> <p>â€¢ Rollup æ˜¯åœ¨ Webpack æµè¡Œåå‡º ç°çš„æ›¿ä»£å“</p> <p>â€¢ Rollup ç”Ÿæ€é“¾è¿˜ä¸å®Œå–„ï¼Œä½“éªŒä¸ å¦‚ Webpack
â€¢ Rollup çš„åŠŸèƒ½ä¸å¦‚ Webpack å®Œå–„ ï¼Œä½†å…¶é…ç½®å’Œä½¿ç”¨æ›´ç®€å•</p> <p>â€¢ Rollup ä¸æ”¯æŒ CodeSplitingï¼Œä½†å¥½å¤„æ˜¯åœ¨æ‰“åŒ…å‡ºæ¥çš„ä»£ç ä¸­æ²¡æœ‰ Webpack é‚£æ®µæ¨¡å— çš„åŠ è½½ã€æ‰§è¡Œå’Œç¼“å­˜çš„ä»£ç </p> <h2 id="æ•´ä½“æµç¨‹åˆ†æ"><a href="#æ•´ä½“æµç¨‹åˆ†æ" class="header-anchor">#</a> æ•´ä½“æµç¨‹åˆ†æ</h2> <h5 id="ç¬¬ä¸€æ­¥ï¼Œæ‰§è¡Œ-webpack-å‡½æ•°ï¼Œåœ¨-webpack-å‡½æ•°ä¸­åˆå§‹åŒ–-compiler-å¯¹è±¡-new-compiler-options-context-ï¼Œåˆå§‹åŒ–è‡ªå®šä¹‰æ’ä»¶-plugin-apply-compiler"><a href="#ç¬¬ä¸€æ­¥ï¼Œæ‰§è¡Œ-webpack-å‡½æ•°ï¼Œåœ¨-webpack-å‡½æ•°ä¸­åˆå§‹åŒ–-compiler-å¯¹è±¡-new-compiler-options-context-ï¼Œåˆå§‹åŒ–è‡ªå®šä¹‰æ’ä»¶-plugin-apply-compiler" class="header-anchor">#</a> ç¬¬ä¸€æ­¥ï¼Œæ‰§è¡Œ webpack å‡½æ•°ï¼Œåœ¨ webpack å‡½æ•°ä¸­åˆå§‹åŒ– compiler å¯¹è±¡ new Compiler(options.context)ï¼Œåˆå§‹åŒ–è‡ªå®šä¹‰æ’ä»¶ plugin.apply(compiler)</h5> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>const webpack = (options, callback) =&gt; {
	let compiler;
	if (typeof options === &quot;object&quot;) {
		options = new WebpackOptionsDefaulter().process(options);
		//åˆ›å»ºç¼–è¯‘å¯¹è±¡
		compiler = new Compiler(options.context);
		compiler.options = options;
		
		
		//å°†Node.jsæ ¼å¼çš„æ–‡ä»¶ç³»ç»Ÿåº”ç”¨äºcompilerã€‚
		new NodeEnvironmentPlugin({
			infrastructureLogging: options.infrastructureLogging
		}).apply(compiler);
		if (options.plugins &amp;&amp; Array.isArray(options.plugins)) {
			for (const plugin of options.plugins) {
			// æ‰§è¡Œè‡ªå®šä¹‰æ’ä»¶
				if (typeof plugin === &quot;function&quot;) {
					plugin.call(compiler, compiler);
				} else {
				
					plugin.apply(compiler);
				}
			}
		}
		//è§¦å‘environmenté’©å­å‡½æ•°ï¼šåœ¨å‡†å¤‡ç¯å¢ƒä¹‹å‰è¿è¡Œæ’ä»¶ã€‚
		compiler.hooks.environment.call();
		// è§¦å‘afterEnvironmenté’©å­å‡½æ•°ï¼šæ‰§è¡Œæ’ä»¶ç¯å¢ƒè®¾ç½®å®Œæˆã€‚
		compiler.hooks.afterEnvironment.call();
		//å¤„ç†é…ç½®ä¸­çš„targetå‚æ•°ï¼Œä¾‹å¦‚ webï¼Œnodeï¼Œæ ¹æ®ä¸åŒé…ç½®ï¼Œé…ç½®é»˜è®¤çš„pluginã€‚
		compiler.options = new WebpackOptionsApply().process(options, compiler);
	} 
	if (callback) {
	 // å¼€å§‹ç¼–è¯‘
		compiler.run(callback);
	}
	// è¿”å›compiler
	return compiler;
};

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>compiler.run(callbackï¼‰æ‰§è¡Œåï¼Œå°±ä¼šæ ¹æ®ç”Ÿå‘½å‘¨æœŸï¼Œæ‰§è¡Œå¯¹åº”çš„äº‹ä»¶é’©å­å‡½æ•°</p> <h5 id="ç¬¬äºŒæ­¥ï¼Œè§¦å‘-webpackoptionsapply-ä¸­é—´ä»¶"><a href="#ç¬¬äºŒæ­¥ï¼Œè§¦å‘-webpackoptionsapply-ä¸­é—´ä»¶" class="header-anchor">#</a> ç¬¬äºŒæ­¥ï¼Œè§¦å‘ WebpackOptionsApply ä¸­é—´ä»¶</h5> <p>åœ¨ compilation é˜¶æ®µä¼šè®°å½•å¥½ä¾èµ–çš„å·¥å‚ç±»ã€‚</p> <p>åœ¨ make é˜¶æ®µçš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ª SingleEntryPlugin å®ä¾‹ã€‚</p> <p>è°ƒç”¨ compilation.addEntry æ–¹æ³•ã€‚</p> <p>addEntry ä¼šè°ƒç”¨ _addModuleChain æ–¹æ³•ï¼Œæœ€ç»ˆç»è¿‡å‡ æ¬¡è°ƒç”¨åä¼šè¿›å…¥åˆ° NormalModule.js ä¸­çš„ build æ–¹æ³•ã€‚</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>class WebpackOptionsApply extends OptionsApply {
    process(options, compiler) {
         ...
        if (typeof options.target === &quot;string&quot;) {
            let JsonpTemplatePlugin;
            let FetchCompileWasmTemplatePlugin;
            let ReadFileCompileWasmTemplatePlugin;
            let NodeSourcePlugin;
            let NodeTargetPlugin;
            let NodeTemplatePlugin;

            switch (options.target) {
                case &quot;web&quot;:
                    ...
                    break;
                case &quot;webworker&quot;:
                    {
                    ....
                        break;
                    }
                case &quot;node&quot;:
                case &quot;async-node&quot;:
                  ...
                    break;
                case &quot;node-webkit&quot;:
                ...
                    break;
                case &quot;electron-main&quot;:

                    break;
                case &quot;electron-renderer&quot;:
                case &quot;electron-preload&quot;:

                    break;

            }
        }
        ...
        new EntryOptionPlugin().apply(compiler);
        ...
    }
}

module.exports = WebpackOptionsApply;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>ä¸Šè¿°ä»£ç  new EntryOptionPlugin().apply(compiler) çš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ª SingleEntryPlugin å®ä¾‹ã€‚</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>// WebpackOptionsApply -&gt; EntryOptionPlugin -&gt;SingleEntryPlugin
class SingleEntryPlugin {
  apply(compiler) {
    compiler.hooks.compilation.tap(
      'SingleEntryPlugin',
      (compilation, { normalModuleFactory }) =&gt; {
        compilation.dependencyFactories.set(
          SingleEntryDependency,
          normalModuleFactory
        );
      }
    );
    compiler.hooks.make.tapAsync(
      'SingleEntryPlugin',
      (compilation, callback) =&gt; {
        const { entry, name, context } = this;
        const dep = SingleEntryPlugin.createDependency(entry, name);
        compilation.addEntry(context, dep, name, callback);
      }
    );
  }
  static createDependency(entry, name) {
    const dep = new SingleEntryDependency(entry);
    dep.loc = { name };
    return dep;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>è°ƒç”¨ compilation.addEntry æ–¹æ³•ã€‚</p> <p>addEntry ä¼šè°ƒç”¨ _addModuleChain æ–¹æ³•ï¼Œæœ€ç»ˆç»è¿‡å‡ æ¬¡è°ƒç”¨åä¼šè¿›å…¥åˆ° NormalModule.js ä¸­çš„ build æ–¹æ³•ã€‚</p> <h5 id="ç¬¬ä¸‰æ­¥ï¼Œè°ƒç”¨-normalmodule-ä¸­çš„-build-æ–¹æ³•"><a href="#ç¬¬ä¸‰æ­¥ï¼Œè°ƒç”¨-normalmodule-ä¸­çš„-build-æ–¹æ³•" class="header-anchor">#</a> ç¬¬ä¸‰æ­¥ï¼Œè°ƒç”¨ NormalModule ä¸­çš„ build æ–¹æ³•</h5> <p>build æ–¹æ³•ä¼šå…ˆæ‰§è¡Œ doBuildï¼Œå°†åŸå§‹ä»£ç ç»è¿‡ loader è¿›è¡Œè½¬ä¹‰ã€‚</p> <p>ç»è¿‡ doBuild ä¹‹åï¼Œæˆ‘ä»¬çš„ä»»ä½•æ¨¡å—éƒ½è¢«è½¬æˆäº†æ ‡å‡†çš„ JS æ¨¡å—ï¼Œé‚£ä¹ˆä¸‹é¢æˆ‘ä»¬å°±å¯ä»¥ç¼–è¯‘ JS äº†</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>doBuild(options, compilation, resolver, fs, callback) {
  const loaderContext = this.createLoaderContext(
    resolver,
    options,
    compilation,
    fs
  );
  // æ‰§è¡Œloaders
  runLoaders(
    {
        resource: this.resource,
        loaders: this.loaders,
        context: loaderContext,
        readResource: fs.readFile.bind(fs)
    },
    (err, result) =&gt; {
      if (result) {
          this.buildInfo.cacheable = result.cacheable;
          this.buildInfo.fileDependencies = new Set(result.fileDependencies);
          this.buildInfo.contextDependencies = new Set(
              result.contextDependencies
          );
      }
      // result æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„ç¬¬ä¸€é¡¹å°±æ˜¯ç¼–è¯‘åçš„ä»£ç 
      const resourceBuffer = result.resourceBuffer;
      const source = result.result[0];
      const sourceMap = result.result.length &gt;= 1 ? result.result[1] : null;
      const extraInfo = result.result.length &gt;= 2 ? result.result[2] : null;
      // this._source æ˜¯ä¸€ä¸ª å¯¹è±¡ï¼Œæœ‰nameå’Œvalueä¸¤ä¸ªå­—æ®µï¼Œnameå°±æ˜¯æˆ‘ä»¬çš„æ–‡ä»¶è·¯å¾„ï¼Œvalueå°±æ˜¯ ç¼–è¯‘åçš„JSä»£ç 
      this._source = this.createSource(
          this.binary ? asBuffer(source) : asString(source),
          resourceBuffer,
          sourceMap
      );
      return callback();
    }
  );
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h5 id="ç¬¬å››æ­¥ï¼Œè°ƒç”¨-parser-parse-æ–¹æ³•ï¼Œå°†ä»£ç è½¬æ¢æˆ-astã€‚-ä½¿ç”¨-parser-åˆ†æé¡¹ç›®ä¾èµ–"><a href="#ç¬¬å››æ­¥ï¼Œè°ƒç”¨-parser-parse-æ–¹æ³•ï¼Œå°†ä»£ç è½¬æ¢æˆ-astã€‚-ä½¿ç”¨-parser-åˆ†æé¡¹ç›®ä¾èµ–" class="header-anchor">#</a> ç¬¬å››æ­¥ï¼Œè°ƒç”¨ parser.parse æ–¹æ³•ï¼Œå°†ä»£ç è½¬æ¢æˆ astã€‚ ä½¿ç”¨ Parser åˆ†æé¡¹ç›®ä¾èµ–</h5> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>build(options, compilation, resolver, fs, callback) {
  return this.doBuild(options, compilation, resolver, fs, err =&gt; {
    // ç¼–è¯‘æˆast
    const result = this.parser.parse(
      this._ast || this._source.source(),
      {
          current: this,
          module: this,
          compilation: compilation,
          options: options
      },
      (err, result) =&gt; {
          if (err) {
              handleParseError(err);
          } else {
              handleParseResult(result);
          }
      }
    );
  });
}

static parse(code, options) {
  let ast;
  let error;
  let threw = false;
  try {
      // ç¼–è¯‘æˆast
      ast = acorn.parse(code, parserOptions);
  } catch (e) {
      error = e;
      threw = true;
  }
  return ast;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h5 id="ç¬¬äº”æ­¥ï¼Œè§£æå®Œ-ast-åï¼Œå°±ä¼šå¯¹æ¯ä¸ªæ¨¡å—æ‰€ä¾èµ–çš„å¯¹è±¡è¿›è¡Œæ”¶é›†"><a href="#ç¬¬äº”æ­¥ï¼Œè§£æå®Œ-ast-åï¼Œå°±ä¼šå¯¹æ¯ä¸ªæ¨¡å—æ‰€ä¾èµ–çš„å¯¹è±¡è¿›è¡Œæ”¶é›†" class="header-anchor">#</a> ç¬¬äº”æ­¥ï¼Œè§£æå®Œ ast åï¼Œå°±ä¼šå¯¹æ¯ä¸ªæ¨¡å—æ‰€ä¾èµ–çš„å¯¹è±¡è¿›è¡Œæ”¶é›†</h5> <p>å¦‚æœæˆ‘ä»¬æœ‰ import a from 'a.js' è¿™æ ·çš„è¯­å¥ï¼Œé‚£ä¹ˆç»è¿‡ babel-loader ä¹‹åä¼šå˜æˆ var a = require('./a.js') ï¼Œè€Œå¯¹è¿™ä¸€å¥çš„å¤„ç†å°±åœ¨ walkStatements ä¸­ï¼Œè¿™é‡Œç»è¿‡äº†å‡ æ¬¡è·³è½¬ï¼Œæœ€ç»ˆä¼šå‘ç°è¿›å…¥äº† walkVariableDeclarators æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬è¿™æ˜¯å£°æ˜äº†ä¸€ä¸ª a å˜é‡ã€‚è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>// import a from 'a.js'
walkVariableDeclaration(statement) {
  for (const declarator of statement.declarations) {
    switch (declarator.type) {
      case &quot;VariableDeclarator&quot;: {
        // è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„å˜é‡å a
        this.walkPattern(declarator.id);
        // è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„è¡¨è¾¾å¼ `require('./a.js')`
        if (declarator.init) this.walkExpression(declarator.init);
        break;
      }
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>è¿™é‡Œçš„ require('./a.js') æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œåœ¨è¿™é‡Œå°±ä¼šåˆ›å»ºä¸€ä¸ªä¾èµ–ï¼Œè®°å½•ä¸‹å¯¹ a.js æ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œæœ€ç»ˆè¿™äº›ä¾èµ–ä¼šè¢«æ”¾åˆ° module.dependencies ä¸­</p> <h5 id="åœ¨æ”¶é›†å®Œæ‰€æœ‰ä¾èµ–ä¹‹åï¼Œä¼šè°ƒç”¨-compilation-seal-æ–¹æ³•ã€‚-ä½¿ç”¨-template-ç”Ÿæˆç»“æœä»£ç "><a href="#åœ¨æ”¶é›†å®Œæ‰€æœ‰ä¾èµ–ä¹‹åï¼Œä¼šè°ƒç”¨-compilation-seal-æ–¹æ³•ã€‚-ä½¿ç”¨-template-ç”Ÿæˆç»“æœä»£ç " class="header-anchor">#</a> åœ¨æ”¶é›†å®Œæ‰€æœ‰ä¾èµ–ä¹‹åï¼Œä¼šè°ƒç”¨ compilation.seal æ–¹æ³•ã€‚ ä½¿ç”¨ Template ç”Ÿæˆç»“æœä»£ç </h5> <p>éå†æ‰€æœ‰çš„ chunk å’Œ chunk æ‰€ä¾èµ–çš„æ–‡ä»¶ã€‚</p> <p>å°†è¿™äº›æ–‡ä»¶é€šè¿‡è°ƒç”¨ MainTemplate ä¸­çš„ render ç”Ÿæˆæœ€ç»ˆä»£ç ã€‚</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>// å°†ç»“æœåŒ…è£¹åˆ°ä¸€ä¸ªIIFEä¸­
renderBootstrap(hash, chunk, moduleTemplate, dependencyTemplates) {
  const buf = [];
  buf.push(
    this.hooks.bootstrap.call(
      &quot;&quot;,
      chunk,
      hash,
      moduleTemplate,
      dependencyTemplates
    )
  );
  buf.push(this.hooks.localVars.call(&quot;&quot;, chunk, hash));
  buf.push(&quot;&quot;);
  buf.push(&quot;// The require function&quot;);
  buf.push(`function ${this.requireFn}(moduleId) {`);
  buf.push(Template.indent(this.hooks.require.call(&quot;&quot;, chunk, hash)));
  buf.push(&quot;}&quot;);
  buf.push(&quot;&quot;);
  buf.push(
    Template.asString(this.hooks.requireExtensions.call(&quot;&quot;, chunk, hash))
  );
  buf.push(&quot;&quot;);
  buf.push(Template.asString(this.hooks.beforeStartup.call(&quot;&quot;, chunk, hash)));
  buf.push(Template.asString(this.hooks.startup.call(&quot;&quot;, chunk, hash)));
  return buf;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="webpack-æ•´ä½“æµç¨‹åˆ†ææ€»ç»“"><a href="#webpack-æ•´ä½“æµç¨‹åˆ†ææ€»ç»“" class="header-anchor">#</a> webpack æ•´ä½“æµç¨‹åˆ†ææ€»ç»“</h2> <h3 id="æµç¨‹æ¦‚æ‹¬"><a href="#æµç¨‹æ¦‚æ‹¬" class="header-anchor">#</a> æµç¨‹æ¦‚æ‹¬</h3> <p>1.åˆå§‹åŒ–å‚æ•°ï¼ˆå¾—åˆ°å‚æ•°ï¼‰ï¼š</p> <p>ä»é…ç½®æ–‡ä»¶ï¼ˆwebpack.config.jsï¼‰ä¸­ä¸ shell è¯­å¥ä¸­è¯»å–ä¸åˆå¹¶å‚æ•°ï¼Œå¾—å‡ºæœ€ç»ˆçš„å‚æ•°ã€‚</p> <p>2.å¼€å§‹ç¼–è¯‘ï¼š</p> <p>ç”¨ä¸Šä¸€æ­¥ä¸­çš„å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ– Compiler å¯¹è±¡ï¼ŒåŠ è½½æ‰€æœ‰é…ç½®æ’ä»¶ï¼Œé€šè¿‡æ‰§è¡Œå¯¹è±¡çš„ run æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘ ã€‚</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>new Compiler(åˆå§‹åŒ–å¾—åˆ°çš„æœ€ç»ˆå‚æ•°)ï¼›

//é€šè¿‡apply åŠ è½½æ‰€æœ‰é…ç½®æ’ä»¶
for (const plugin of options.plugins) {
			// æ‰§è¡Œè‡ªå®šä¹‰æ’ä»¶
				if (typeof plugin === &quot;function&quot;) {
					plugin.call(compiler, compiler);
				} else {
				
					plugin.apply(compiler);
				}
			}
			
//æ‰§è¡Œå¯¹è±¡çš„run æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘
compiler.run(callback);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>3.ç¡®å®šå…¥å£ï¼š</p> <p>æ ¹æ®é…ç½®ä¸­çš„ entry æ‰¾å‡ºæ‰€æœ‰å…¥å£æ–‡ä»¶ ã€‚</p> <p>WebpackOptionsApply -&gt; EntryOptionPlugin -&gt;SingleEntryPlugin</p> <p>4.ç¼–è¯‘æ¨¡å—:
ä»å…¥å£æ–‡ä»¶å‡ºå‘ï¼Œå¼€å§‹ compilation è¿‡ç¨‹ï¼Œè°ƒç”¨æ‰€æœ‰é…ç½®çš„ Loader å¯¹æ¨¡å—è¿›è¡Œç¿»è¯‘ï¼Œå†å°†ç¼–è¯‘å¥½çš„æ–‡ä»¶å†…å®¹è§£ææˆ AST é™æ€è¯­æ³•æ ‘ï¼Œå†æ‰¾å‡ºè¯¥
æ¨¡å—ä¾èµ–çš„æ¨¡å—ï¼Œå†é€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡äº†æœ¬æ­¥éª¤çš„å¤„ç† ã€‚</p> <p>5.å®Œæˆæ¨¡å—ç¼–è¯‘</p> <p>ç»è¿‡ç¬¬ 4 æ­¥ä½¿ç”¨ Loader ç¿»è¯‘å®Œæ‰€æœ‰æ¨¡å—åï¼Œç”Ÿæˆ AST è¯­æ³•æ ‘ï¼Œåœ¨ AST è¯­æ³•æ ‘ä¸­å¯ä»¥åˆ†æåˆ°æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¯¹åº”åšå‡ºä¼˜åŒ–ã€‚</p> <p>6.è¾“å‡ºèµ„æº</p> <p>å°†æ‰€æœ‰æ¨¡å—ä¸­çš„ require è¯­æ³•æ›¿æ¢æˆ__webpack_require__æ¥æ¨¡æ‹Ÿæ¨¡å—åŒ–æ“ä½œã€‚</p> <p>7.æœ€åæŠŠæ‰€æœ‰çš„æ¨¡å—æ‰“åŒ…è¿›ä¸€ä¸ªè‡ªæ‰§è¡Œå‡½æ•°ï¼ˆIIFEï¼‰ä¸­ã€‚</p> <h3 id="æµç¨‹å›¾"><a href="#æµç¨‹å›¾" class="header-anchor">#</a> æµç¨‹å›¾</h3> <p>è¿™å¼ å›¾ç”»çš„å¾ˆå¥½ï¼ŒæŠŠ webpack çš„æµç¨‹ç”»çš„å¾ˆç»†è‡´ã€‚</p> <p><img src="https://wendaoshuai66.github.io/study/note/images/webpack_%E6%B5%81%E7%A8%8B%E5%9B%BE.png" alt=""></p> <h2 id="ç¼–å†™æ’ä»¶"><a href="#ç¼–å†™æ’ä»¶" class="header-anchor">#</a> ç¼–å†™æ’ä»¶</h2> <h3 id="ä¸€ä¸ªæœ€åŸºç¡€çš„-plugin-çš„ä»£ç æ˜¯è¿™æ ·çš„"><a href="#ä¸€ä¸ªæœ€åŸºç¡€çš„-plugin-çš„ä»£ç æ˜¯è¿™æ ·çš„" class="header-anchor">#</a> ä¸€ä¸ªæœ€åŸºç¡€çš„ Plugin çš„ä»£ç æ˜¯è¿™æ ·çš„</h3> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>class basePlugin {
    constructor(options){
        //ç”¨æˆ·è‡ªå®šä¹‰é…ç½®
        this.options = options
        console.log(this.options)
    }
    apply(compiler) {
        console.log(&quot;This is my first plugin.&quot;)
    }
}

module.exports = basePlugin


const BasicPlugin =require (â€™./BasicPlugå·¥n. j s â€™); 
module.export = {

    plugins:[
     new. BasicPlugin();
    ]

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>Webpack å¯åŠ¨å</p> <p>1.åœ¨è¯»å–é…ç½®çš„è¿‡ç¨‹ä¸­ä¼šå…ˆæ‰§è¡Œ new BasicPlugin(options )ï¼Œåˆå§‹åŒ–ä¸€ä¸ª BasicPlugin å¹¶è·å¾—å…¶å®ä¾‹ã€‚
2.åœ¨åˆå§‹åŒ– compiler å¯¹è±¡åï¼Œ</p> <p>3.å†è°ƒç”¨ basicPlugin.apply (compiler)ä¸ºæ’ä»¶å®ä¾‹ä¼ å…¥ compiler å¯¹è±¡ã€‚</p> <p>4.æ’ä»¶å®ä¾‹åœ¨è·å–åˆ° compiler å¯¹è±¡åï¼Œ å°±å¯ä»¥é€šè¿‡ compiler.plugin (äº‹ä»¶åç§°ï¼Œå›è°ƒå‡½æ•°)ç›‘å¬åˆ° Webpack å¹¿æ’­çš„äº‹ä»¶ï¼Œ å¹¶ä¸”å¯ä»¥é€šè¿‡ compiler å¯¹è±¡å»æ“ä½œ Webpack.</p> <p>è¿™å°±æ˜¯æœ€ç®€å•çš„ PluginğŸ˜Šï¼Œ ä½†åœ¨å®é™…å¼€å‘ä¸­è¿˜ æœ‰å¾ˆå¤šç»†èŠ‚éœ€è¦æ³¨æ„ ï¼Œä¸‹é¢è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚</p> <h3 id="åˆ°åº•-compiler-å’Œ-compilation-æ˜¯ä»€ä¹ˆ"><a href="#åˆ°åº•-compiler-å’Œ-compilation-æ˜¯ä»€ä¹ˆ" class="header-anchor">#</a> åˆ°åº• Compiler å’Œ Compilation æ˜¯ä»€ä¹ˆ</h3> <p>å¼€å‘ Plugin æ—¶æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå¯¹è±¡å°±æ˜¯ Compiler å’Œ Compilationï¼Œå®ƒä»¬æ˜¯ Plugin å’Œ Webpack
ä¹‹é—´çš„æ¡¥æ¢ã€‚ Compiler å’Œ Compilation çš„å«ä¹‰å¦‚ä¸‹ã€‚</p> <p>Compiler å¯¹è±¡åŒ…å«äº† Webpack ç¯å¢ƒçš„æ‰€æœ‰é…ç½®ä¿¡æ¯ï¼ŒåŒ…å« optionsã€loadersã€plugins ç­‰ä¿¡æ¯ã€‚è¿™ä¸ªå¯¹è±¡åœ¨ Webpack å¯åŠ¨æ—¶è¢«å®ä¾‹åŒ–ï¼Œå®ƒæ˜¯å…¨å±€å”¯ä¸€çš„ï¼Œå¯ä»¥ç®€å•åœ°å°† å®ƒç†è§£ä¸º Webpack å®ä¾‹ã€‚</p> <p>Compiler-----ã€‹ Webpack å®ä¾‹</p> <p>Compilation å¯¹è±¡åŒ…å«äº†å½“å‰çš„æ¨¡å—èµ„æºã€ç¼–è¯‘ç”Ÿæˆèµ„æºã€å˜åŒ–çš„æ–‡ä»¶ç­‰ã€‚å½“ Webpack ä»¥å¼€å‘æ¨¡å¼è¿è¡Œæ—¶ï¼Œæ¯å½“æ£€æµ‹åˆ°ä¸€ä¸ªæ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œä¾¿æœ‰ä¸€æ¬¡æ–°çš„ Compilation è¢«
åˆ›å»º ã€‚ Compilation å¯¹è±¡ä¹Ÿæä¾›äº†å¾ˆå¤šäº‹ä»¶å›è°ƒä¾›æ’ä»¶è¿›è¡Œæ‰©å±•ã€‚é€šè¿‡ Compilation ä¹Ÿèƒ½è¯»å–åˆ° Compiler å¯¹è±¡ã€‚</p> <p>Compiler å’Œ Compilation çš„åŒºåˆ«åœ¨äº: Compiler ä»£è¡¨äº†æ•´ä¸ª Webpack ä»å¯åŠ¨åˆ°å…³é—­çš„ç”Ÿå‘½å‘¨æœŸï¼Œè€Œ Compilation åªä»£è¡¨ä¸€æ¬¡æ–°çš„ç¼–è¯‘ã€‚</p> <h3 id="æ¸©ä¹ ä¸€ä¸‹-webpack-äº‹ä»¶æµ"><a href="#æ¸©ä¹ ä¸€ä¸‹-webpack-äº‹ä»¶æµ" class="header-anchor">#</a> æ¸©ä¹ ä¸€ä¸‹ webpack äº‹ä»¶æµ</h3> <p>webpack å°±åƒæ˜¯æˆ‘ä»¬å·¥å‚ä¸­æµæ°´çº¿ï¼Œè¦ç»è¿‡ä¸€ç³»åˆ—çš„æµç¨‹æ‰ä¼šæŠŠæˆ‘ä»¬çš„æºç è½¬åŒ–æˆè¾“å‡ºç»“æœ ã€‚åœ¨è¿™æ¡æµæ°´çº¿å½“ä¸­æ¯ä¸ªå¤„ç†æµç¨‹çš„èŒè´£éƒ½æ˜¯å•ä¸€çš„ï¼Œå¤šä¸ªæµç¨‹ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œåªæœ‰åœ¨å®Œæˆå½“å‰å¤„ç†åæ‰èƒ½æäº¤ç»™ä¸‹ä¸€ä¸ªæµç¨‹å»å¤„ç†ã€‚æ’ä»¶å°±åƒæ’å…¥ç”Ÿäº§çº¿ä¸­çš„æŸä¸ªåŠŸèƒ½ï¼Œåœ¨ç‰¹å®šçš„æ—¶æœºå¯¹ç”Ÿäº§çº¿ä¸Šçš„èµ„æºè¿›è¡Œå¤„ç†ã€‚</p> <p>Webpack é€šè¿‡ Tapable <a href="https://github.com/webpack/tapable" target="_blank" rel="noopener noreferrer">(https://github.com/webpack/tapable)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>æ¥ç»„ç»‡è¿™æ¡å¤æ‚çš„æµæ°´çº¿ã€‚ Webpack åœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¼šå¹¿æ’­äº‹ä»¶ï¼Œæ’ä»¶åªéœ€è¦ç›‘å¬å®ƒæ‰€å…³å¿ƒçš„äº‹ä»¶ï¼Œå°±èƒ½åŠ å…¥è¿™æ¡ç”Ÿäº§çº¿ä¸­ï¼Œå»æ”¹å˜æµæ°´çº¿çš„è¿ä½œã€‚ Webpack çš„äº‹ä»¶æµæœºåˆ¶ä¿è¯äº†æ’ä»¶çš„æœ‰åºæ€§ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿçš„æ‰©å±•æ€§è‰¯å¥½ã€‚</p> <p>Webpack çš„äº‹ä»¶æµæœºåˆ¶åº”ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå’Œ Node æ‰£ä¸­çš„ EventEmitter éå¸¸ç›¸ä¼¼ ã€‚Compiler å’Œ Compilation éƒ½ç»§æ‰¿è‡ª Tapableï¼Œå¯ä»¥ç›´æ¥åœ¨ Compiler å’Œ Compilation å¯¹è±¡ä¸Šå¹¿æ’­å’Œç›‘æ˜•äº‹ ä»¶ï¼Œæ–¹æ³•å¦‚ä¸‹:</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>/**
*å¹¿æ’­äº‹ä»¶
é£Ÿ event-name ä¸ºäº‹ä»¶åç§°ï¼Œæ³¨æ„ä¸è¦å’Œç°æœ‰çš„äº‹ä»¶é‡å * params ä¸ºé™„å¸¦çš„å‚æ•°
*/
compiler.apply â€™event-nameâ€™, params);
/**
*ç›‘æ˜•åç§°ä¸º event-name çš„äº‹ä»¶ï¼Œå½“ event-name äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œ ã€‚ *åŒæ—¶å‡½æ•°ä¸­çš„ params å‚æ•°ä¸ºå¹¿æ’­äº‹ä»¶æ—¶é™„å¸¦çš„å‚æ•° ã€‚
*/
compiler.plugin (â€™event-nameâ€™, function (params) {

} ) ,
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-plain line-numbers-mode"><pre class="language-text"><code>class SyncHook{
    constructor(){
        this.hooks = {}
    }

    // è®¢é˜…äº‹ä»¶
    tap(name, fn){
    
        this.hooks[name] = [fn]
    }

    // å‘å¸ƒ
    call(){
        this.hooks[name].forEach(fn=&gt;fn())
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="å®æˆ˜å‰–æ"><a href="#å®æˆ˜å‰–æ" class="header-anchor">#</a> å®æˆ˜å‰–æ</h3> <p>æ¥çœ‹ä¸€çœ‹å·²ç»è¢«ä¼—äººç©åçš„ html-webpack-plugin</p> <div class="language-plain line-numbers-mode"><pre class="language-text"><code>const pluginName = 'ConsoleLogOnBuildWebpackPlugin';


let assetsHelp = (data) =&gt; {
    let js = [];
    let css = [];
    let dir = {
        js: item =&gt; `&lt;script src=&quot;${item}&quot; class=&quot;lazyload-js&quot; type=&quot;module&quot;&gt;&lt;/script&gt;`,
        css: item =&gt; `&lt;link rel=&quot;stylesheet&quot; href=&quot;${item}&quot;&gt;`
    }
    for (let jsitem of data.js) {
        js.push(dir.js(jsitem))
    }
    for (let cssitem of data.css) {
        css.push(dir.js(cssitem))
    }
    return {
        js,
        css
    }
}


class ConsoleLogOnBuildWebpackPlugin {
    apply(compiler) {
        compiler.hooks.compilation.tap(pluginName, compilation =&gt; {

            compilation.hooks.htmlWebpackPluginAfterHtmlProcessing.tap(pluginName, (webpackPluginData) =&gt; {
                console.log('ğŸğŸğŸğŸğŸ', webpackPluginData.assets)
                let _html = webpackPluginData.html;
                let result = assetsHelp(webpackPluginData.assets)
                _html = _html.replace(/@components/g, '../../../components');
                _html = _html.replace('&lt;!--injectjs--&gt;', result.js.join(''));
                _html = _html.replace('&lt;!--injectcss--&gt;', result.css.join(''));
                webpackPluginData.html = _html;
            })
        });

    }
}
module.exports = ConsoleLogOnBuildWebpackPlugin;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/wendaoshuai66/blogs/edit/master/docs/blog/Webpackä½¿ç”¨æ€»ç»“.md" target="_blank" rel="noopener noreferrer">æœ¬æ–‡æºç åœ°å€</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">æ›´æ–°æ—¶é—´:</span> <span class="time">2/5/2020, 1:10:59 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/blog/Webpack.html" class="prev">
        å¸¸ç”¨çš„å‰ç«¯æ„å»ºå·¥å…·-Webpack
      </a></span> <span class="next"><a href="/blog/Webpackç³»åˆ—æ‰‹å†™æ¨¡å—æ‰“åŒ…ä»£ç .html">
        Webpack ç³»åˆ—æ‰‹å†™æ¨¡å—æ‰“åŒ…ä»£ç 
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7db32d51.js" defer></script><script src="/assets/js/2.1f0a0a54.js" defer></script><script src="/assets/js/28.fc75bc52.js" defer></script>
  </body>
</html>
